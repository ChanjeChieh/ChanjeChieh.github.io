<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://chanjechieh.github.io/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://ChanjeChieh.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/05/26/hello-world/" class="article-date">
  <time class="dt-published" datetime="2024-05-26T07:22:44.460Z" itemprop="datePublished">2024-05-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/05/26/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chanjechieh.github.io/2024/05/26/hello-world/" data-id="clwn8c9f00003p4sheuvrh9r9" data-title="Hello World" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-《尚医通》笔记" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/09/26/%E3%80%8A%E5%B0%9A%E5%8C%BB%E9%80%9A%E3%80%8B%E7%AC%94%E8%AE%B0/" class="article-date">
  <time class="dt-published" datetime="2022-09-26T03:29:12.000Z" itemprop="datePublished">2022-09-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/09/26/%E3%80%8A%E5%B0%9A%E5%8C%BB%E9%80%9A%E3%80%8B%E7%AC%94%E8%AE%B0/">《尚医通》笔记</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="一、MyBatis-Plus（持久化层）"><a href="#一、MyBatis-Plus（持久化层）" class="headerlink" title="一、MyBatis-Plus（持久化层）"></a>一、MyBatis-Plus（持久化层）</h2><h3 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h3><p>MyBatis-Plus 是一个MyBatis 的增强工具</p>
<ul>
<li>支持多种数据库</li>
<li>内置通用的增删改查</li>
<li>内置分页插件，并支持多种数据库</li>
<li>版本 8 以上的 MySQL 配置数据库信息时添加时区信息：serverTimeZone&#x3D;UTC</li>
</ul>
<h3 id="2-注解"><a href="#2-注解" class="headerlink" title="2. 注解"></a>2. 注解</h3><h4 id="2-1-TableName-注解"><a href="#2-1-TableName-注解" class="headerlink" title="2.1 @TableName 注解"></a>2.1 @TableName 注解</h4><p>MyBatis-Plus 官网的 demo 中：</p>
<ul>
<li>pojo 类的类名和数据库中表的名字是对应的</li>
<li>如果不对应，可以使用 @TableName 注解来指定 pojo 类对应数据库中的表名</li>
</ul>
<p>换句话说：</p>
<ul>
<li>MyBatis-Plus 会根据 BaseMapper 泛型 pojo 类名去映射一个数据表</li>
<li>如果 mp 找不到数据表，可以使用 @TableName 注解指定表名，mp 就会根据指定的表名去映射一个数据表</li>
</ul>
<h4 id="2-2-TableField-注解"><a href="#2-2-TableField-注解" class="headerlink" title="2.2 @TableField 注解"></a>2.2 @TableField 注解</h4><p>mp 在数据库中找到表后：</p>
<ul>
<li>mp 会将没下划线的列名把首字母变成小写，然后映射到 pojo 属性上，以下划线分割的列名会转换为驼峰命名（也可以通过下面 application.yaml 文件中的配置取消，见下面的代码段），然后再映射到 pojo 类的属性上</li>
<li>如果在数据表中映射不到列名的话，可以使用 @TableField 注解指定了字段名，mp 就根据指定的字段名去映射数据表中的列名</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>以 MySQL 数据表 user 中字段 nick_name 为例，把 ”下划线转驼峰命名“ 设为 false 后想把 pojo 类和数据表映射起来有两种方法：</p>
<ol>
<li>直接属性名，和数据表中列名完全一致，即 String nick_name</li>
<li>使用 @TableField 注解，无论属性名是什么，mp 都会把表中的值绑定上去</li>
</ol>
<blockquote>
<p> 如果同时：</p>
<ol>
<li>开启驼峰命名转换</li>
<li>pojo 类的属性上加了正确的 @TableField 注解</li>
<li>但属性名不是驼峰命名</li>
</ol>
<p> 这种情况，相关字段也查不到结果（因为这个注解只对查询有作用，数据返回时会被 yaml 中的配置抵消掉从而不起作用，不确定，留个坑）</p>
</blockquote>
<p>所以，@TableField 和 application.yaml 中 ”下划线转驼峰命名“ 设置为 false 的配置不能同时使用（短见）</p>
<h4 id="2-2-TableId-注解（主键生成策略）"><a href="#2-2-TableId-注解（主键生成策略）" class="headerlink" title="2.2 @TableId 注解（主键生成策略）"></a>2.2 @TableId 注解（主键生成策略）</h4><ul>
<li>表示这个字段是 pojo 类对应表的主键，可进行自增操作</li>
<li>如果不设置这个属性的值就进行 insert 操作，就需要用到  mp 的 <strong>主键生成策略</strong>（通过 @TableId 的 type 属性设置）：<ul>
<li>NONE：使用 “雪花算法” 生成主键（19 位数值类型的 id，也是 mp 的默认主键生成策略，<strong>推荐使用</strong>）</li>
<li>INPUT：指定使用用户输入的主键值</li>
<li>AUTO：使用数据表的自增主键（两个要求：id 字段为数值类型，id 字段为自增类型）</li>
<li>ASSIGN_ID：指定用户输入 id，没有输入的话使用 NONE</li>
<li>ASSIGN_UUID：指定用户输入 uuid，没有输入的话使用 NONE，使用 Java 生成 uuid 的方法：</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1、直接使用 UUID 工具生成的 uuid 带有四个 “-”，需要删除</span></span><br><span class="line"><span class="type">String</span> <span class="variable">uuid</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line">System.out.println(uuid);</span><br><span class="line"><span class="comment">// 32e9b6af-f048-4438-8037-0456a3517114 </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2、对生成的 uuid 进行 replaceAll 操作，删除四个 “-”，变成真正的 32 位 uuid</span></span><br><span class="line"><span class="type">String</span> <span class="variable">uuid</span> <span class="operator">=</span> UUID.randomUUID().toString().replaceAll cao<span class="string">&#x27;z(&quot;-&quot;, &quot;&quot;);</span></span><br><span class="line"><span class="string">System.out.println(uuid);</span></span><br><span class="line"><span class="string">// d550d5010b134a21ad569fadbd5a3b1f</span></span><br></pre></td></tr></table></figure>

<p>但是：</p>
<ul>
<li>uuid 是字符类型，不便于搜索；</li>
<li>mysql 自带的自增数值类型在进行分库分表的时候会发生冲突</li>
</ul>
<p>因此推荐使用 mp 自带的雪花算法</p>
<h3 id="3-增删改查"><a href="#3-增删改查" class="headerlink" title="3. 增删改查"></a>3. 增删改查</h3><p>mp 针对四种操作提供了简单的接口可以直接调用，且包括：</p>
<ul>
<li>逻辑删除</li>
<li>分页查询</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="number">10l</span>, <span class="string">&quot;lisi&quot;</span>, <span class="number">18</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 增加</span></span><br><span class="line">userMapper.insert(user);</span><br><span class="line"><span class="comment">// 2. 删除</span></span><br><span class="line">userMapper.deleteById(user);</span><br><span class="line"><span class="comment">// 3. 修改</span></span><br><span class="line">userMapper.updateById(user);</span><br><span class="line"><span class="comment">// 4. 查询</span></span><br><span class="line"><span class="comment">//  4.1 直接根据 id 查询</span></span><br><span class="line">userMapper.selectById(<span class="number">10l</span>);</span><br><span class="line"><span class="comment">//  4.2 根据存储 id 值的列表查询</span></span><br><span class="line">userMapper.selectBatchIds(Arrays.asList(<span class="number">1l</span>, <span class="number">2l</span>, <span class="number">3l</span>, <span class="number">4l</span>));</span><br><span class="line"><span class="comment">//  4.3 根据 map 存储字段的值进行与查询</span></span><br><span class="line">HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">map.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;may&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;age&quot;</span>, <span class="number">18</span>);</span><br><span class="line">userMapper.selectByMap(map);</span><br></pre></td></tr></table></figure>

<h3 id="4-自动填充"><a href="#4-自动填充" class="headerlink" title="4. 自动填充"></a>4. 自动填充</h3><p>实际数据表里面经常需要记录一下数据的创建时间（create time）和修改时间（update time），一般情况下编写业务逻辑的时候需要手动编码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user.setCreateTime(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">user.setUpdateTime(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br></pre></td></tr></table></figure>

<p>而 mp 自带了自动填充功能，不需要在编写业务逻辑的时候对这些字段进行编码，<strong>实现方法</strong> 如下两步：</p>
<ol>
<li>在需要自动填充的属性上添加注解：@TableField(fill &#x3D; FieldFill.INSERT) 或 @TableField(fill &#x3D; FieldFill.UPDATE) </li>
<li>编写代码，实现 MetaObjectHandler 接口，并添加 @component 注解将其放入 spring 容器中管理</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.mysql_;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.handlers.MetaObjectHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.reflection.MetaObject;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMetaObjectHandler</span> <span class="keyword">implements</span> <span class="title class_">MetaObjectHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.setFieldValByName(<span class="string">&quot;createTime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>(), metaObject);</span><br><span class="line">        <span class="built_in">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>(), metaObject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>(), metaObject);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-乐观锁"><a href="#5-乐观锁" class="headerlink" title="5. 乐观锁"></a>5. 乐观锁</h3><p>一般的业务使用悲观锁：一个业务正在对一条数据进行操作的时候，不允许其他事务对该事务进行操作，所以悲观锁的特点是：</p>
<ul>
<li>优点：可以保证数据的安全性、正确性</li>
<li>缺点：降低了并发度</li>
</ul>
<p>乐观锁不同的是，它在数据表中添加一个 int 类型的 version 字段，所有业务都能同时进行写操作，但每次写操作结束后都要先判断表中的 version 是不是和取值的时候一致，一致的话继续写入，并对 version 加一；否则不能写入。mp 实现乐观锁的如下三步：</p>
<ol>
<li>在数据表中加入 int 类型的字段 version，对应的 pojo 同</li>
<li>在 pojo 类中 version 属性上添加 @version 注解</li>
<li>配置自动填充插件（见上面 4. 自动填充）和乐观锁插件（mp 官网有）</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.inner.OptimisticLockerInnerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 乐观锁插件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">OptimisticLockerInnerInterceptor</span>());</span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>添加乐观锁后，对数据的修改时会让 version 版本号 +1，</p>
<h3 id="6-分页查询"><a href="#6-分页查询" class="headerlink" title="6. 分页查询"></a>6. 分页查询</h3><p>mp 自带分页插件，需要先使用核心插件配置自动分页插件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        <span class="comment">// 1、乐观锁插件</span></span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">OptimisticLockerInnerInterceptor</span>());</span><br><span class="line">        <span class="comment">// 2、新的分页插件,一缓和二缓遵循mybatis的规则,需要设置:</span></span><br><span class="line">        <span class="comment">//    MybatisConfiguration#useDeprecatedExecutor = false</span></span><br><span class="line">        <span class="comment">//    避免缓存出现问题 (该属性会在旧插件移除后一同移除)</span></span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>(DbType.H2));</span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @Bean</span></span><br><span class="line"><span class="comment">//    public ConfigurationCustomizer configurationCustomizer() &#123;</span></span><br><span class="line"><span class="comment">//        return configuration -&gt; configuration.setUseDeprecatedExecutor(false);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后就可以直接用了（Wrapper 功能待更）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  4.4 分页查询（需要配置插件，mp 官网有代码）</span></span><br><span class="line">Page&lt;User&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line">Page&lt;User&gt; userPage = userMapper.selectPage(page, <span class="literal">null</span>);</span><br></pre></td></tr></table></figure>

<h3 id="7-逻辑删除"><a href="#7-逻辑删除" class="headerlink" title="7. 逻辑删除"></a>7. 逻辑删除</h3><p>实现步骤如下：</p>
<ol>
<li>在数据表中添加 tinyint 类型的 deleted 字段，设置默认值 0（或使用 mp 的自动填充）</li>
<li>在 pojo 类中添加属性并添加 @TableLogic 注解<strong>（重点）</strong></li>
</ol>
<p>done</p>
<ul>
<li><p>这样以后再删除数据的时候就只是把 deleted 改为 1（也就是逻辑删除）</p>
</li>
<li><p>查询的时候 mp 也会在查询语句后面带上查询条件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WHERE deleted=0</span><br></pre></td></tr></table></figure></li>
</ul>
<p>也可以用 yaml 配置文件：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">logic-delete-field:</span> <span class="string">deleted</span> <span class="comment"># 这里配置了就不用在 deleted 属性上加注解了</span></span><br><span class="line">      <span class="attr">logic-delete-value:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">logic-not-delete-value:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h3 id="8-Wrapper-介绍"><a href="#8-Wrapper-介绍" class="headerlink" title="8. Wrapper 介绍"></a>8. Wrapper 介绍</h3><p>wrapper 是 mp 封装好的条件构造器，将程序员和 sql 语句进行 “解耦合” 。。。类的继承关系如下图：</p>
<p>![在这里插入图片描述](D:\Chanje&#96;s Blog\source_posts\《尚医通》笔记\watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAcXFfNTA5NzU5NjU&#x3D;,size_13,color_FFFFFF,t_70,g_se,x_16)</p>
<p>使用方式举个例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println((<span class="string">&quot;----- selectAll method test ------&quot;</span>));</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">    queryWrapper.eq(<span class="string">&quot;age&quot;</span>, <span class="number">18</span>); <span class="comment">// 使用多个条件的时候结合 HashMap 和 allEq 一起用</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.selectOne(queryWrapper); <span class="comment">// 查多个用 selectList</span></span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println((<span class="string">&quot;----- selectAll method test ------&quot;</span>));</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">    queryWrapper.eq(<span class="string">&quot;age&quot;</span>, <span class="number">18</span>).or().eq(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Sandy&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="9-自定义-sql-语句"><a href="#9-自定义-sql-语句" class="headerlink" title="9. 自定义 sql 语句"></a>9. 自定义 sql 语句</h3><p>实现方法：</p>
<ul>
<li>在 UserMapper 接口中定义的函数加 @select 注解</li>
<li>如果有多个参数需要使用 @Param 注解</li>
<li>select 语句使用 #() 获取参数的值</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;User&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where age &gt; #&#123;age&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectUserList</span><span class="params">(<span class="meta">@Param(value = &quot;age&quot;)</span> Integer age)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="10-使用-mp-快速生成-Service-层"><a href="#10-使用-mp-快速生成-Service-层" class="headerlink" title="10. 使用 mp 快速生成 Service 层"></a>10. 使用 mp 快速生成 Service 层</h3><p>（其实还有代码自动生成工具，更简单）</p>
<p>如果想要自己的 Service 层拥有 mp 预先定义好的增删改查方法，需要：</p>
<ul>
<li>让接口继承 IService 方法</li>
<li>让实现类继承 ServiceImpl 抽象类并实现自定义接口</li>
</ul>
<p>实现方法：</p>
<p>Service 文件目录如下：</p>
<ul>
<li>service（包）<ul>
<li>impl（包）<ul>
<li>UserServiceImpl.java</li>
</ul>
</li>
<li>UserService.java</li>
</ul>
</li>
</ul>
<p>具体代码：</p>
<ul>
<li><p>UserServiceImpl.java 核心代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span></span><br><span class="line">        <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper, User&gt;</span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">UserService</span>  &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>UserService.java  核心代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;User&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>如果有自定义 sql 的需求：</p>
<ol>
<li>在 UserService.java 中定义方法：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;User&gt; <span class="title function_">getUserList</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在 UserServiceImpl.java 中实现该方法：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;User&gt; <span class="title function_">getUserList</span><span class="params">()</span> &#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; userWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">    userWrapper.ge(<span class="string">&quot;age&quot;</span>, <span class="number">22</span>);</span><br><span class="line">    <span class="keyword">return</span> baseMapper.selectList(userWrapper); <span class="comment">// UserMapper 会被自动注入到 baseMapper 中</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二、控制台输出"><a href="#二、控制台输出" class="headerlink" title="二、控制台输出"></a>二、控制台输出</h2><h3 id="1-打印日志"><a href="#1-打印日志" class="headerlink" title="1. 打印日志"></a>1. 打印日志</h3><p>如果想查看程序查询数据的时候用的查询语句，可以在 application.yaml 中进行配置：</p>
<p>一种方式（logging-level）：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="comment"># root: debug # 表示整个项目下 debug 级别及以上的日志</span></span><br><span class="line">    <span class="attr">com.example.mysql_:</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure>

<p>另一种方式（mybatis-plus 自带工具）：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure>

<h3 id="2-打印-List-列表的四种方法"><a href="#2-打印-List-列表的四种方法" class="headerlink" title="2. 打印 List 列表的四种方法"></a>2. 打印 List 列表的四种方法</h3><ol>
<li>for 循环</li>
<li>增强 for 循环</li>
<li>迭代器</li>
<li>流</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">    queryWrapper.ge(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;18&quot;</span>);</span><br><span class="line">    List&lt;User&gt; userList = userMapper.selectList(queryWrapper);</span><br><span class="line">    <span class="comment">// 1. for 循环</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; userList.size(); i++)</span><br><span class="line">        System.out.print(userList.get(i) + <span class="string">&quot; &quot;</span>);</span><br><span class="line">    System.out.println();</span><br><span class="line">    <span class="comment">// 2. for 增强</span></span><br><span class="line">    <span class="keyword">for</span> (User user : userList)</span><br><span class="line">        System.out.print(user + <span class="string">&quot; &quot;</span>);</span><br><span class="line">    System.out.println();</span><br><span class="line">    <span class="comment">// 3. 迭代器</span></span><br><span class="line">    Iterator&lt;User&gt; iterator = userList.iterator();</span><br><span class="line">    <span class="keyword">while</span> (iterator.hasNext())</span><br><span class="line">        System.out.print(iterator.next());</span><br><span class="line">    System.out.println();</span><br><span class="line">    <span class="comment">// 4. 流</span></span><br><span class="line">    Stream&lt;User&gt; userStream = userList.stream(); <span class="comment">// 也可以用并行流 parallelStream()</span></span><br><span class="line">    userStream.forEach(item-&gt;&#123;</span><br><span class="line">        System.out.println(item);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>函数式接口：被子类实现的方法有且只有一个</li>
<li>lambda 表达式：简便实现函数式接口的方法</li>
</ul>
<h2 id="三、项目搭建"><a href="#三、项目搭建" class="headerlink" title="三、项目搭建"></a>三、项目搭建</h2><h3 id="1-数据库设计"><a href="#1-数据库设计" class="headerlink" title="1. 数据库设计"></a>1. 数据库设计</h3><ol>
<li>库名尽量和应用名称保持一致</li>
<li>表名和字段名使用小写字母和数字（不能出现在开头）</li>
<li>表名不能是复数</li>
<li>表必须有三个字段：ID（bigint unsigned）、create_time 和 update_time</li>
<li>单表行数超过 500 万，或者单表的大小超过 2GB 才可分库分表</li>
<li>数据库中的布尔类型需要 is 开头（unsigned tinyint），pojo 类中不需要</li>
<li>小数使用 decimal 类型，不能用 float 和 double</li>
<li>字符串定长用 char，不等长用 varchar，长度超过 5000 用 text 并且做分表（避免影响检索速度）</li>
<li>唯一索引名用 uk 开头，普通索引名用 idx 开头</li>
<li>分布式等系统不能联表查询，可以用空间换时间</li>
</ol>
<h3 id="2-项目结构"><a href="#2-项目结构" class="headerlink" title="2. 项目结构"></a>2. 项目结构</h3><p>打包格式：有子项目的使用 pom 包，其他使用 jar 包，方便管理子模块的依赖版本</p>
<p>构建方式：除了 parent 聚合项目（使用 springboot 的方式创建，这样会继承父工程），其他项目都使用 maven 创建</p>
<ul>
<li>父工程（yygh_parent）<ul>
<li>model：pojo 类、枚举类、VO 类</li>
<li>coder：根据数据表自动生成代码</li>
<li>common 模块：<ul>
<li>common_util：所有模块通用的工具类</li>
<li>service_util：service 模块使用的工具类</li>
<li>rabbitmq_util：rabbitmq 使用的工具类</li>
</ul>
</li>
<li>service 模块：微服务<ul>
<li>service_hosp：医院 api 接口服务</li>
<li>service_cmn：公共 api 接口服务</li>
<li>service_user：用户 api 接口服务</li>
<li>service_order：订单 api 接口服务</li>
<li>service_oss：文件 api 接口服务</li>
<li>service_msm：短信 api 接口服务</li>
<li>service_task：定时任务服务</li>
<li>service_statistics：统计api接口服务</li>
</ul>
</li>
<li>service-client 模块：<ul>
<li>service-cmn-client：公共 api 接口</li>
<li>service-hosp-client：医院 api 接口</li>
<li>service-order-client：订单 api 接口</li>
</ul>
</li>
<li>gateway 模块：对外提供微服务的统一入口</li>
</ul>
</li>
</ul>
<h3 id="3-实操"><a href="#3-实操" class="headerlink" title="3. 实操"></a>3. 实操</h3><p>先创建父工程 yygh_parent，然后使用 idea 的 module 创建模块功能分别创建 model、service、coder 以及 service 的子模块 service_hosp，其中：</p>
<ul>
<li>model：直接拷贝资料中的源文件</li>
</ul>
<p><img src="/image-20220930110355038.png" alt="image-20220930110355038"></p>
<ul>
<li>service：手动创建后配置并导入依赖</li>
</ul>
<p><img src="/image-20220930110411575.png" alt="image-20220930110411575"></p>
<ul>
<li>service_hosp：手动创建后配置并导入依赖</li>
</ul>
<p><img src="/image-20220930110440902.png" alt="image-20220930110440902"></p>
<ul>
<li>coder：手动创建后使用 mp 官网给定的自动生成代码的模板在 service_hosp 下根据数据表自动生成代码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.exceptions.MybatisPlusException;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.toolkit.StringUtils;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.AutoGenerator;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.*;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 演示例子，执行 main 方法控制台输入模块表名回车自动生成对应项目目录中</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CodeGenerator</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 读取控制台内容</span></span><br><span class="line"><span class="comment">     * &lt;/p&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">scanner</span><span class="params">(String tip)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">help</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        help.append(<span class="string">&quot;请输入&quot;</span> + tip + <span class="string">&quot;：&quot;</span>);</span><br><span class="line">        System.out.println(help.toString());</span><br><span class="line">        <span class="keyword">if</span> (scanner.hasNext()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">ipt</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isNotBlank(ipt)) &#123;</span><br><span class="line">                <span class="keyword">return</span> ipt;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusException</span>(<span class="string">&quot;请输入正确的&quot;</span> + tip + <span class="string">&quot;！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 代码生成器</span></span><br><span class="line">        <span class="type">AutoGenerator</span> <span class="variable">mpg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AutoGenerator</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 全局配置</span></span><br><span class="line">        <span class="type">GlobalConfig</span> <span class="variable">gc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GlobalConfig</span>();</span><br><span class="line">        <span class="comment">// String projectPath = System.getProperty(&quot;user.dir&quot;);</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> <span class="string">&quot;D:/Developer/Codespace/Java/H2/yygh_parent/service/service_hosp/src/main/&quot;</span>;</span><br><span class="line">        gc.setOutputDir(path + <span class="string">&quot;/java&quot;</span>);</span><br><span class="line">        gc.setServiceName(<span class="string">&quot;%sService&quot;</span>);</span><br><span class="line">        gc.setAuthor(<span class="string">&quot;deepchieh&quot;</span>);</span><br><span class="line">        gc.setOpen(<span class="literal">false</span>);</span><br><span class="line">        <span class="comment">// gc.setSwagger2(true); 实体属性 Swagger2 注解</span></span><br><span class="line">        mpg.setGlobalConfig(gc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 数据源配置</span></span><br><span class="line">        <span class="type">DataSourceConfig</span> <span class="variable">dsc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataSourceConfig</span>();</span><br><span class="line">        dsc.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/yygh_hosp?useUnicode=true&amp;characterEncoding=utf8&quot;</span>);</span><br><span class="line">        <span class="comment">// dsc.setSchemaName(&quot;public&quot;);</span></span><br><span class="line">        dsc.setDriverName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        dsc.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dsc.setPassword(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        mpg.setDataSource(dsc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 包配置</span></span><br><span class="line">        <span class="type">PackageConfig</span> <span class="variable">pc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PackageConfig</span>();</span><br><span class="line">        pc.setModuleName(<span class="string">&quot;hosp&quot;</span>);</span><br><span class="line">        pc.setParent(<span class="string">&quot;com.atguigu.yygh&quot;</span>);</span><br><span class="line">        pc.setController(<span class="string">&quot;controller&quot;</span>);</span><br><span class="line">        pc.setService(<span class="string">&quot;service&quot;</span>);</span><br><span class="line">        pc.setMapper(<span class="string">&quot;mapper&quot;</span>);</span><br><span class="line">        pc.setEntity(<span class="string">&quot;entity&quot;</span>);</span><br><span class="line">        mpg.setPackageInfo(pc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 策略配置</span></span><br><span class="line">        <span class="type">StrategyConfig</span> <span class="variable">strategy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StrategyConfig</span>();</span><br><span class="line">        strategy.setInclude(<span class="string">&quot;hospital_set&quot;</span>);</span><br><span class="line">        strategy.setNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        strategy.setColumnNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        strategy.setEntityLombokModel(<span class="literal">true</span>);</span><br><span class="line">        strategy.setRestControllerStyle(<span class="literal">true</span>);</span><br><span class="line">        strategy.setControllerMappingHyphenStyle(<span class="literal">true</span>);</span><br><span class="line">        mpg.setStrategy(strategy);</span><br><span class="line">        mpg.execute();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Note：</p>
<ul>
<li>包含子工程的模块都需要把打包格式改为 pom，方便管理子模块的依赖版本</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>删掉 coder 模块自动生成的 entity，使用 model 模块下的 pojo 文件</li>
</ul>
<h3 id="4-编写、测试简单的接口"><a href="#4-编写、测试简单的接口" class="headerlink" title="4. 编写、测试简单的接口"></a>4. 编写、测试简单的接口</h3><p><strong>（一）查询</strong></p>
<ol>
<li>使用 Service 中的 hospitalSetService.list() 的方法实现一个 findAll 接口来返回所有的数据</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/hosp/hospitalSet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HospitalSetController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> HospitalSetService hospitalSetService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @RequestMapping 支持所有的请求方式</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/findall&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;HospitalSet&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> hospitalSetService.list();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>启动 service_hosp 微服务来测试 findAll 接口</li>
<li>返回 json 文件到前端的时候，在 create_time 属性添加下面的注解，update_time 上不添加</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br></pre></td></tr></table></figure>

<p>​		得到的结果如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;createTime&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2021-07-29 07:18:08&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;updateTime&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2021-07-29T07:18:08.000+0000&quot;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>



<p>除了添加注解（局部配置）的方法，还可以在 yaml 中进行 controller 层的全局配置：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jackson:</span></span><br><span class="line">  <span class="attr">date-format:</span> <span class="string">yyyy-MM-dd</span> <span class="string">HH:mm:ss</span></span><br><span class="line">  <span class="attr">time-zone:</span> <span class="string">GMT+8</span></span><br></pre></td></tr></table></figure>



<p><strong>（二）删除</strong>（逻辑删除）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping(value = &quot;/deleteById/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteById</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> hospitalSetService.removeById(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>&#x2F;&#x2F; 也可以使用 @RequestParam(“id”) 注解<br>&#x2F;&#x2F; 如果前端返回的数据名和参数名一致的时候，RequestParam 注解可以省略</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping(value = &quot;/deleteById&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteById</span><span class="params">(<span class="meta">@RequestParam(&quot;id&quot;)</span> Integer id)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> hospitalSetService.removeById(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<ol>
<li>这里使用 chrome 插件 Talend API Tester 测试接口</li>
<li>不能用 https 开头，</li>
</ol>
</blockquote>
<h2 id="四、接口工具-Swagger2"><a href="#四、接口工具-Swagger2" class="headerlink" title="四、接口工具 Swagger2"></a>四、接口工具 Swagger2</h2><p>Swagger2 是既可以自动生成接口文档、也可以测试接口的 springboot 插件工具</p>
<h3 id="1-Swagger-使用"><a href="#1-Swagger-使用" class="headerlink" title="1. Swagger 使用"></a>1. Swagger 使用</h3><p>实现方法如下：</p>
<ol>
<li>pom.xml 文件中添加两个依赖：</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--swagger--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在配置类中提供 Docket 对象并添加 @EnableSwagger 注解</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span> <span class="comment">// 开启 Swagger 支持</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SwaggerConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Docket <span class="title function_">getAdminDocket</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2).groupName(<span class="string">&quot;admin&quot;</span>)</span><br><span class="line">                .apiInfo(getAdminApiInfo()).select()</span><br><span class="line">                .paths(Predicates.and(PathSelectors.regex(<span class="string">&quot;/admin/.*&quot;</span>)))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>在需要使用 Swagger 子模块中添加 swagger 所在子模块的依赖，并在主启动类上添加 @Component 注解（仅基于微服务的系统）</p>
</li>
<li><p>启动微服务后，使用浏览器通过微服务端口访问  swagger-ui.html 页面，如：<a target="_blank" rel="noopener" href="http://localhost:8201/swagger-ui.html">http://localhost:8201/swagger-ui.html</a></p>
</li>
</ol>
<p>如果在 controller 里写了 @RequestMapping 注解，swagger 页面会把所有请求方式都列出来：</p>
<ul>
<li>get</li>
<li>post</li>
<li>delete</li>
<li>head</li>
<li>put</li>
<li>patch</li>
<li>options</li>
</ul>
<h3 id="2-配置-Swagger"><a href="#2-配置-Swagger" class="headerlink" title="2.  配置 Swagger"></a>2.  配置 Swagger</h3><h4 id="2-1-接口分组查看"><a href="#2-1-接口分组查看" class="headerlink" title="2.1 接口分组查看"></a>2.1 接口分组查看</h4><p>下的代码把 Admin 替换成 User 后，  swagger-ui.html  页面就有了 User 的分组和内部的接口，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Docket <span class="title function_">getAdminDocket</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2).groupName(<span class="string">&quot;admin&quot;</span>)</span><br><span class="line">            .apiInfo(getAdminApiInfo()).select()</span><br><span class="line">            .paths(Predicates.and(PathSelectors.regex(<span class="string">&quot;/admin/.*&quot;</span>))) <span class="comment">// 只查看 admin 开头的接口</span></span><br><span class="line">            .build();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> ApiInfo <span class="title function_">getAdminApiInfo</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ApiInfoBuilder</span>()</span><br><span class="line">            .title(<span class="string">&quot;管理员系统&quot;</span>)</span><br><span class="line">            .description(<span class="string">&quot;尚医通预约挂号平台后台管理员系统&quot;</span>)</span><br><span class="line">            .version(<span class="string">&quot;1.0&quot;</span>)</span><br><span class="line">            .contact(<span class="keyword">new</span> <span class="title class_">Contact</span>(<span class="string">&quot;deepchieh&quot;</span>, <span class="string">&quot;https://chanjechieh.github.io/&quot;</span>, <span class="string">&quot;deepchieh@gmail.com&quot;</span>))</span><br><span class="line">            .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>效果图：</p>
<p><img src="/image-20221004153813311.png" alt="image-20221004153813311"></p>
<h4 id="2-2-接口说明-ApiOperation"><a href="#2-2-接口说明-ApiOperation" class="headerlink" title="2.2 接口说明 @ApiOperation"></a>2.2 接口说明 @ApiOperation</h4><ul>
<li>在 Controller <strong>类上</strong>添加 @API 注解：（因为配置分组信息后，会让每个 Controller 类变成一个分组，所以这个 @API 注解就是给一个分组配置说明信息）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Api(tags = &quot;医院设置信息&quot;)</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在 Controller <strong>类里的方法上</strong>添加 @ApiOperation 注解：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;查询所有的医院设置信息&quot;)</span></span><br></pre></td></tr></table></figure>



<p>效果图：</p>
<p><img src="/image-20221004153749257.png" alt="image-20221004153749257"></p>
<h4 id="2-3-参数说明-ApiParam"><a href="#2-3-参数说明-ApiParam" class="headerlink" title="2.3 参数说明 @ApiParam"></a>2.3 参数说明 @ApiParam</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;根据医院设置id删除医院设置信息&quot;)</span></span><br><span class="line"><span class="meta">@DeleteMapping(value = &quot;/deleteById/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteById</span><span class="params">(<span class="meta">@ApiParam(name = &quot;id&quot;, value = &quot;医院设置id&quot;, required = true)</span> Integer id)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> hospitalSetService.removeById(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>效果图：</p>
<p><img src="/image-20221004155104447.png" alt="image-20221004155104447"></p>
<h2 id="五、统一返回结果"><a href="#五、统一返回结果" class="headerlink" title="五、统一返回结果"></a>五、统一返回结果</h2><h3 id="1、-实现方法"><a href="#1、-实现方法" class="headerlink" title="1、 实现方法"></a>1、 实现方法</h3><p>为了使前端对数据的操作更简单，后端一般会将相应封装成 json 返回，一般情况下，统一返回数据格式没有固定格式，只要能描述清楚响应并返回相应的数据即可，但是一般会包含状态码、返回消息，数据几部分：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">R</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line">    <span class="keyword">private</span> Boolean success;</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Object&gt; data = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了方便编写代码，通过连缀的方式提供这个类，我们给这个统一返回结果实现 ok 和 error 两个静态方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> R <span class="title function_">ok</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">R</span>(REnum.SUCCESS.getCode(),</span><br><span class="line">                REnum.SUCCESS.getFlag(),</span><br><span class="line">                REnum.SUCCESS.getMessage());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> R <span class="title function_">error</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">R</span>(REnum.ERROR.getCode(),</span><br><span class="line">            REnum.ERROR.getFlag(),</span><br><span class="line">            REnum.ERROR.getMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>并提供设置属性信息的普通方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> R <span class="title function_">code</span> <span class="params">(Integer code)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.code = code;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">success</span> <span class="params">(Boolean success)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.success = success;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">message</span><span class="params">(String message)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.message = message;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">data</span><span class="params">(String key, Object value)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.data.put(key, value);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">data</span><span class="params">(Map&lt;String, Object&gt; hashMap)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.data = hashMap;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了避免对 R  对象状态码的硬编码，实现一个枚举类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">REnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    SUCCESS (<span class="number">0</span>, <span class="string">&quot;成功&quot;</span>, <span class="literal">true</span>),</span><br><span class="line">    ERROR (<span class="number">1</span>, <span class="string">&quot;失败&quot;</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 枚举项</span></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    <span class="keyword">private</span> Boolean flag;</span><br><span class="line"></span><br><span class="line">    REnum(Integer code, String message, Boolean flag) &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">        <span class="built_in">this</span>.flag = flag;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 各个属性的 get、set 方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2、-作用"><a href="#2、-作用" class="headerlink" title="2、 作用"></a>2、 作用</h3><p>以查询数据库中的数据为例：</p>
<ol>
<li>没有统一返回结果的时候返回一个 List：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;查询所有的医院设置信息&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/findall&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;HospitalSet&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; haspMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">return</span> hospitalSetService.list();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>编写代码后可以改为返回 R，里面包含了状态码、描述信息和数据：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;查询所有的医院设置信息&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/findall&quot;)</span></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; haspMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    haspMap.put(<span class="string">&quot;data&quot;</span>, hospitalSetService.list());</span><br><span class="line">    <span class="keyword">return</span> R.ok().data(haspMap);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>项目可以配置全局异常处理，因此暂时不考虑</p>
</blockquote>
<h2 id="六、ValueObject（VO）和分页查询"><a href="#六、ValueObject（VO）和分页查询" class="headerlink" title="六、ValueObject（VO）和分页查询"></a>六、ValueObject（VO）和分页查询</h2><p><strong>ValueObject（VO）：</strong></p>
<p>以包含有密码、地址等信息的用户表为例，如果其他用户查看该用户的用户名时，后端系统返回了地址等信息不太合适，所以引入 ValueObject，只返回特定网页需要显示的信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.yygh.vo.hosp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HospitalSetQueryVo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;医院名称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String hosname;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;医院编号&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String hoscode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>分页查询：</strong></p>
<p>除了后端返回的数据不再是 List 而是统一返回对象和 ValueObject，其他的使用和前面介绍 mp 时的使用方法一致：</p>
<ol>
<li>首先 在 common 里 service_utils 模块下进行分页配置：</li>
</ol>
<p><strong>yygh_parent</strong>\common\<strong>service_utils</strong>\src\main\java\com\atguigu\yygh\<strong>common\config</strong>\PageConfig.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.yygh.common.config;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> PaginationInterceptor <span class="title function_">paginationInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PaginationInterceptor</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在 controller 中调用 service 的 page 方法</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;带查询条件的分页&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(value = &quot;/page/&#123;pageNum&#125;/&#123;size&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">getPageInfo</span><span class="params">(<span class="meta">@ApiParam(name = &quot;pageNum&quot;, value = &quot;当前页&quot;)</span> <span class="meta">@PathVariable</span> Integer pageNum,</span></span><br><span class="line"><span class="params">                     <span class="meta">@ApiParam(name = &quot;size&quot;, value = &quot;每页数据数量&quot;)</span> <span class="meta">@PathVariable</span> Integer size,</span></span><br><span class="line"><span class="params">                     <span class="meta">@RequestBody</span> HospitalSetQueryVo hospitalQueryVo)</span> &#123;</span><br><span class="line">    <span class="comment">// 判断前端返回的 hosname 和 hoscode 是否为空</span></span><br><span class="line">    QueryWrapper&lt;HospitalSet&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">if</span> (!StringUtils.isEmpty(hospitalQueryVo.getHosname()))</span><br><span class="line">        queryWrapper.like(<span class="string">&quot;hosname&quot;</span>, hospitalQueryVo.getHosname());</span><br><span class="line">    <span class="keyword">if</span> (!StringUtils.isEmpty(hospitalQueryVo.getHoscode()))</span><br><span class="line">        queryWrapper.like(<span class="string">&quot;hoscode&quot;</span>, hospitalQueryVo.getHoscode());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用模糊查询把结果存到 page 中</span></span><br><span class="line">    Page&lt;HospitalSet&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;();</span><br><span class="line">    page = hospitalSetService.page(page, queryWrapper);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回 总数据量 和 数据</span></span><br><span class="line">    <span class="keyword">return</span> R.ok().data(<span class="string">&quot;total&quot;</span>, page.getTotal()).data(<span class="string">&quot;rows&quot;</span>, page.getRecords());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="七、统一异常处理"><a href="#七、统一异常处理" class="headerlink" title="七、统一异常处理"></a>七、统一异常处理</h2><h3 id="1、-真-全局处理"><a href="#1、-真-全局处理" class="headerlink" title="1、 真*全局处理"></a>1、 真*全局处理</h3><p>如果 controller 层处理逻辑的时候出现错误或者异常，前端在调用接口时，如果不做异常捕获，错误信息就会直接打印到前端页面上， 对用户不友好，So，需要在后端进行异常处理：</p>
<p>找个合适的地方新建一个类，叫 GlobalExceptionHandler：</p>
<ol>
<li>加上 @RestControllerAdvice 注解，这个注解默认可以扫描全部实现类</li>
<li>@RestControllerAdvice 配合 @ExceptionHandler 注解可以实现全局异常处理</li>
<li>如果用 @ControllerAdvice 注解，那这个类的方法上都要加上 @ResponseBody 注解</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.yygh.common.handler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.yygh.common.result.R;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;</span><br><span class="line"></span><br><span class="line"><span class="comment">//@ControllerAdvice</span></span><br><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> R <span class="title function_">handlerException</span><span class="params">(Exception exception)</span> &#123;</span><br><span class="line">        <span class="comment">// 错误信息一般会保存在日志文件中，这里暂时打印到控制台</span></span><br><span class="line">        exception.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> R.error().message(exception.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2、细粒度异常处理"><a href="#2、细粒度异常处理" class="headerlink" title="2、细粒度异常处理"></a>2、细粒度异常处理</h3><p>上面的处理方法无脑处理所有的异常，也可以对异常进行细粒度处理，比如 sql 异常、数学异常等</p>
<p>实现方法就是在 GlobalExceptionHandler 类里面编写不同的方法分别处理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.yygh.common.handler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.yygh.common.result.R;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="comment">//@ControllerAdvice</span></span><br><span class="line"><span class="meta">@RestControllerAdvice</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 细粒度的异常处理：Sql异常</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = SQLException.class)</span></span><br><span class="line">    <span class="keyword">public</span> R <span class="title function_">handleSqlException</span><span class="params">(SQLException sqlException)</span> &#123;</span><br><span class="line">        sqlException.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> R.error().message(<span class="string">&quot;Sql异常&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 细粒度的异常处理：数学异常</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = ArithmeticException.class)</span></span><br><span class="line">    <span class="keyword">public</span> R <span class="title function_">handleArithmeticException</span><span class="params">(ArithmeticException arithmeticException)</span> &#123;</span><br><span class="line">        arithmeticException.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> R.error().message(<span class="string">&quot;数学异常&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 细粒度的异常处理：运行时异常</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = RuntimeException.class)</span></span><br><span class="line">    <span class="keyword">public</span> R <span class="title function_">handleRuntimeException</span><span class="params">(RuntimeException runtimeException)</span> &#123;</span><br><span class="line">        runtimeException.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> R.error().message(<span class="string">&quot;运行时异常&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3、异常处理优先级"><a href="#3、异常处理优先级" class="headerlink" title="3、异常处理优先级"></a>3、异常处理优先级</h3><p>一个异常属于多个异常类型，而且 GlobalExceptionHandler 类里面针对这些异常都编写了处理类，那 spring 会优先处理最细粒度的异常（也就是异常继承树最下面的异常）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">Throwable--&gt;Exception</span><br><span class="line">Throwable--&gt;Error</span><br><span class="line">Exception--&gt;SQLException</span><br><span class="line">Exception--&gt;RuntimeException</span><br><span class="line">RuntimeException--&gt;NullPointerException</span><br><span class="line">RuntimeException--&gt;ArithmeticException</span><br></pre></td></tr></table></figure>

<h3 id="4、自定义异常信息"><a href="#4、自定义异常信息" class="headerlink" title="4、自定义异常信息"></a>4、自定义异常信息</h3><p>三步：</p>
<ol>
<li>先定义一个自定义异常类：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.yygh.common.exception;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">YyghException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">YyghException</span><span class="params">(Integer code, String message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMessage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCode</span><span class="params">(Integer code)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在 GlobalExceptionHandler 类中配置全局自定义异常处理：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自定义异常 yyghException，使用的时候必须自己手动抛出这个异常</span></span><br><span class="line"><span class="meta">@ExceptionHandler(value = YyghException.class)</span></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">handleRuntimeException</span><span class="params">(YyghException yyghException)</span> &#123;</span><br><span class="line">    yyghException.printStackTrace();</span><br><span class="line">    <span class="keyword">return</span> R.error().message(yyghException.getMessage()).code(yyghException.getCode());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>最后在 controller 中先捕获 Exception，然后再手动抛出我们自定义的异常：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;查询所有的医院设置信息&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/findAll&quot;)</span></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; haspMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        haspMap.put(<span class="string">&quot;data&quot;</span>, hospitalSetService.list());</span><br><span class="line">        <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">0</span> / <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception yyghException) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">YyghException</span>(<span class="number">2000113</span>, <span class="string">&quot;XXX异常&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> R.ok().data(haspMap);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="八、统一日志管理"><a href="#八、统一日志管理" class="headerlink" title="八、统一日志管理"></a>八、统一日志管理</h2><h3 id="1、logback-介绍和配置"><a href="#1、logback-介绍和配置" class="headerlink" title="1、logback 介绍和配置"></a>1、logback 介绍和配置</h3><ol>
<li>SpringBoot 项目只要在 pom.xml 文件里面添加了 spring-boot-starter-web 依赖，就可以用 logback 记录日志了</li>
<li>SpringBoot 项目可以通过 logging.config&#x3D;classpath:xxx.xml 来指定配置文件，但默认加载这三个文件：<ol>
<li>classpath:logback.xml</li>
<li>classpath:logback-spring.xml</li>
<li>classpath:logback-spring.groovy</li>
</ol>
</li>
</ol>
<p>logback-spring.xml 配置文件的内容如下，文件内容比较多，但也不难，就是定义了 log.path 和 CONSOLE_LOG_PATTERN两个变量，然后用 appender 标签定义几个打印日志的组件，最后用 springProfile 标签和 root 标签合作完成不同环境下打印日志的方式：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>  <span class="attr">scan</span>=<span class="string">&quot;true&quot;</span> <span class="attr">scanPeriod</span>=<span class="string">&quot;10 seconds&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 日志级别从低到高分为TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATAL，如果设置为WARN，则低于WARN的信息都不会输出 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- scan:当此属性设置为true时，配置文件如果发生改变，将会被重新加载，默认值为true --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- scanPeriod:设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当scan为true时，此属性生效。默认的时间间隔为1分钟。 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- de<span class="doctag">bug:</span>当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为false。 --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">contextName</span>&gt;</span>logback<span class="tag">&lt;/<span class="name">contextName</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- name的值是变量的名称，value的值时变量定义的值。通过定义的值会被插入到logger上下文中。定义变量后，可以使“$&#123;&#125;”来使用变量。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;log.path&quot;</span> <span class="attr">value</span>=<span class="string">&quot;D:/Developer/Codespace/Java/yygh_parent/guli_log/yygh&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 彩色日志 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置格式变量：CONSOLE_LOG_PATTERN 彩色日志格式 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- magenta:洋红 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- boldMagenta:粗红--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- cyan:青色 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- white:白色 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- magenta:洋红 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;CONSOLE_LOG_PATTERN&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">&quot;%yellow(%date&#123;yyyy-MM-dd HH:mm:ss&#125;) |%highlight(%-5level) |%blue(%thread) |%blue(%file:%line) |%green(%logger) |%cyan(%msg%n)&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--输出到控制台--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;CONSOLE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 此日志appender是为开发使用，只配置最底级别，控制台输出的日志级别是大于或等于此级别的日志信息--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 例如：如果此处配置了INFO级别，则后面其他位置即使配置了DEBUG级别的日志，也不会被输出 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>INFO<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Pattern</span>&gt;</span>$&#123;CONSOLE_LOG_PATTERN&#125;<span class="tag">&lt;/<span class="name">Pattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 设置字符集 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--输出到文件--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 时间滚动输出 level 为 INFO 日志 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;INFO_FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 正在记录的日志文件的路径及文件名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;log.path&#125;/log_info.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志文件输出格式--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 日志记录器的滚动策略，按日期，按大小记录 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 每天日志归档路径以及格式 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;log.path&#125;/info/log-info-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>100MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志文件保留天数--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>15<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 此日志文件只记录info级别的 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>INFO<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 时间滚动输出 level为 WARN 日志 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;WARN_FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 正在记录的日志文件的路径及文件名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;log.path&#125;/log_warn.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志文件输出格式--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span> <span class="comment">&lt;!-- 此处设置字符集 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 日志记录器的滚动策略，按日期，按大小记录 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;log.path&#125;/warn/log-warn-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>100MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志文件保留天数--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>15<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 此日志文件只记录warn级别的 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>warn<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 时间滚动输出 level为 ERROR 日志 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;ERROR_FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 正在记录的日志文件的路径及文件名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;log.path&#125;/log_error.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志文件输出格式--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span> <span class="comment">&lt;!-- 此处设置字符集 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 日志记录器的滚动策略，按日期，按大小记录 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;log.path&#125;/error/log-error-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>100MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志文件保留天数--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>15<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 此日志文件只记录ERROR级别的 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>ERROR<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        &lt;logger&gt;用来设置某一个包或者具体的某一个类的日志打印级别、以及指定&lt;appender&gt;。</span></span><br><span class="line"><span class="comment">        &lt;logger&gt;仅有一个name属性，</span></span><br><span class="line"><span class="comment">        一个可选的level和一个可选的addtivity属性。</span></span><br><span class="line"><span class="comment">        name:用来指定受此logger约束的某一个包或者具体的某一个类。</span></span><br><span class="line"><span class="comment">        level:用来设置打印级别，大小写无关：TRACE, DEBUG, INFO, WARN, ERROR, ALL 和 OFF，</span></span><br><span class="line"><span class="comment">              如果未设置此属性，那么当前logger将会继承上级的级别。</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        使用mybatis的时候，sql语句是debug下才会打印，而这里我们只配置了info，所以想要查看sql语句的话，有以下两种操作：</span></span><br><span class="line"><span class="comment">        第一种把&lt;root level=&quot;INFO&quot;&gt;改成&lt;root level=&quot;DEBUG&quot;&gt;这样就会打印sql，不过这样日志那边会出现很多其他消息</span></span><br><span class="line"><span class="comment">        第二种就是单独给mapper下目录配置DEBUG模式，代码如下，这样配置sql语句会打印，其他还是正常DEBUG级别：</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--开发环境:打印控制台--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">springProfile</span> <span class="attr">name</span>=<span class="string">&quot;dev&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--可以输出项目中的debug日志，包括mybatis的sql日志--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;com.guli&quot;</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            root节点是必选节点，用来指定最基础的日志输出级别，只有一个level属性</span></span><br><span class="line"><span class="comment">            level:用来设置打印级别，大小写无关：TRACE, DEBUG, INFO, WARN, ERROR, ALL 和 OFF，默认是DEBUG</span></span><br><span class="line"><span class="comment">            可以包含零个或多个appender元素。</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;CONSOLE&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;INFO_FILE&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;WARN_FILE&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ERROR_FILE&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">springProfile</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--生产环境:输出到文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">springProfile</span> <span class="attr">name</span>=<span class="string">&quot;pro&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;CONSOLE&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;DEBUG_FILE&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;INFO_FILE&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ERROR_FILE&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;WARN_FILE&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">springProfile</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2、结合异常处理信息"><a href="#2、结合异常处理信息" class="headerlink" title="2、结合异常处理信息"></a>2、结合异常处理信息</h3><p>先介绍 Slf4j，它是一个日志标准，不是日志系统的具体实现，logback 是日志系统的具体实现，如果在 一个类上加了这个注解，就相当于在这个类里面加了一行代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> org.slf4j.<span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> org.slf4j.LoggerFactory.getLogger(LogExample.class);</span><br></pre></td></tr></table></figure>

<p>先在全局异常处理类 GlobalExceptionHandler 上添加 @Slf4j 注解，然后在类里面已经添加 @ExceptionHandler 注解的方法里使用 log.error （也可以是 debug、info 等等）方法打印日志，这里选了什么级别的日志，就会调用日志文件里对应级别的日志打印格式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@ControllerAdvice</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestControllerAdvice</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> R <span class="title function_">handleException</span><span class="params">(Exception exception)</span> &#123;</span><br><span class="line">        exception.printStackTrace();</span><br><span class="line">        <span class="comment">// ！！</span></span><br><span class="line">        log.error(exception.getMessage());</span><br><span class="line">        <span class="keyword">return</span> R.error().message(exception.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="九、前端"><a href="#九、前端" class="headerlink" title="九、前端"></a>九、前端</h2><h3 id="1、ES6-新特性"><a href="#1、ES6-新特性" class="headerlink" title="1、ES6 新特性"></a>1、ES6 新特性</h3><p>JavaScript 包含三部分：</p>
<ul>
<li>ECMAScript：es5 + es6 的语法规范和关键字<ul>
<li>es5 定义变量用 var，es6 定义变量用 let</li>
</ul>
</li>
<li>DOM：Document Object Model，文档对象模型</li>
<li>BOM：Browser Object Model 浏览器对象模型</li>
</ul>
<p> ECMAScript 6 教程：<a target="_blank" rel="noopener" href="https://wangdoc.com/es6/">https://wangdoc.com/es6/</a></p>
<ol>
<li>let 和 var 关键字</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// - let 关键字声明的关键字有作用域</span></span><br><span class="line"><span class="comment">// - let 声明的变量不能重复声明</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">let</span> b = <span class="number">11</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b); <span class="comment">// 报错</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>( <span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (i == <span class="number">10</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">10</span>); <span class="comment">// let 声明会报错，var 声明的话不会报错</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>Es6 新增 const</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// const 变量</span></span><br><span class="line"><span class="comment">//  - 常量必须初始化</span></span><br><span class="line"><span class="comment">//  - 常量不能修改</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = <span class="string">&quot;ada&quot;</span></span><br><span class="line">a = <span class="string">&quot;sad&quot;</span></span><br><span class="line"></span><br><span class="line">报错：<span class="title class_">Uncaught</span> <span class="title class_">TypeError</span>: <span class="title class_">Assignment</span> to constant variable.</span><br><span class="line">    at <span class="keyword">let</span>.<span class="property">html</span>:<span class="number">12</span>:<span class="number">11</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>解构赋值</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 传统变量和 es6 变量赋值的区别</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>, b = <span class="number">2</span>, c = <span class="number">3</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a, b, c)</span><br><span class="line"><span class="keyword">let</span> [x, y, z] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x, y, z)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象解构赋值用大括号</span></span><br><span class="line"><span class="keyword">var</span> student = &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;xiaoming&quot;</span>&#125;</span><br><span class="line"><span class="keyword">var</span> &#123;id, name&#125; = student</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(id, name)</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>模板字符串</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1、支持换行</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="string">`asd</span></span><br><span class="line"><span class="string">11</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">asda`</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="comment">//2、支持引用变量</span></span><br><span class="line"><span class="keyword">let</span> name = <span class="string">&quot;David&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> age = <span class="number">18</span>;</span><br><span class="line"><span class="keyword">let</span> s = <span class="string">`我叫<span class="subst">$&#123;name&#125;</span>，我今年<span class="subst">$&#123;age&#125;</span>岁`</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment">//3、支持函数调用</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;xiaoming&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> a = <span class="string">`hello <span class="subst">$&#123;hello()&#125;</span>`</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>对象和方法的简写</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// es5 定义方法需要写 function</span></span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">    <span class="attr">sayHi</span>:<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;obj1: sayHi()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj1.<span class="title function_">sayHi</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// es6 定义方法可以省略 function</span></span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;</span><br><span class="line">    <span class="title function_">sayHi</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;obj2: sayHi()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj2.<span class="title function_">sayHi</span>();</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>拓展运算符 …（三个点，可以取出参数对象所有可遍历属性，然后拷贝到当前对象）</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = &#123;<span class="attr">username</span>: <span class="string">&quot;adasd&quot;</span>, <span class="attr">age</span>: <span class="number">121</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1、深拷贝</span></span><br><span class="line"><span class="keyword">var</span> c1 = &#123; ...obj1 &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 浅拷贝&#125;</span></span><br><span class="line"><span class="keyword">var</span> c2 = obj1</span><br><span class="line"><span class="keyword">var</span> c3 = obj1</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c1)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c2)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c3)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c1 == c2)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c2 == c3)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印结果：</span></span><br><span class="line"><span class="comment">//  Objectage: 121username: &quot;adasd&quot;[[Prototype]]: Object</span></span><br><span class="line"><span class="comment">//  Objectage: 121username: &quot;asdadadadasdadadassasa&quot;[[Prototype]]: Object</span></span><br><span class="line"><span class="comment">//  Objectage: 121username: &quot;asdadadadasdadadassasa&quot;[[Prototype]]: Object</span></span><br><span class="line"><span class="comment">//  false</span></span><br><span class="line"><span class="comment">//  true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2、合并对象</span></span><br><span class="line"><span class="keyword">let</span> age = &#123;<span class="attr">age</span>: <span class="number">15</span>&#125;</span><br><span class="line"><span class="keyword">let</span> name = &#123;<span class="attr">name</span>: <span class="string">&quot;Amy&quot;</span>&#125;</span><br><span class="line"><span class="keyword">let</span> person2 = &#123;...age, ...name&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person2)  </span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印结果：</span></span><br><span class="line"><span class="comment">// &#123;age: 15, name: &quot;Amy&quot;&#125;</span></span><br></pre></td></tr></table></figure>

<ol start="7">
<li>箭头函数：lambda 表达式</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 简化部分：</span></span><br><span class="line"><span class="comment">//  【1】 function 关键字改成 =&gt;</span></span><br><span class="line"><span class="comment">//  【2】 只有一个参数的时候，()可以省略</span></span><br><span class="line"><span class="comment">//  【3】 函数体只有一行代码时，&#123;&#125;可以省略</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// add1 是简化后的函数，add2 是传统定义函数的代码</span></span><br><span class="line"><span class="keyword">var</span> <span class="title function_">add1</span> = (<span class="params">a, b</span>) =&gt; a + b;</span><br><span class="line"><span class="keyword">var</span> add2 = <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add1</span>(<span class="number">100</span>, <span class="number">7</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add2</span>(<span class="number">100</span>, <span class="number">7</span>));</span><br></pre></td></tr></table></figure>

<h3 id="2、Vue"><a href="#2、Vue" class="headerlink" title="2、Vue"></a>2、Vue</h3><h4 id="2-1-Vue-使用"><a href="#2-1-Vue-使用" class="headerlink" title="2.1 Vue 使用"></a>2.1 Vue 使用</h4><p>Vue 是一个 MVVM 架构的框架</p>
<ul>
<li>M：Model</li>
<li>V：View</li>
<li>VM：ViewModel，当前 vue 对象</li>
</ul>
<ol>
<li>引入 vue.js（开发的时候使用）或 vue.min.js （发布的时候使用）</li>
</ol>
<p>Vue.min.js：<a target="_blank" rel="noopener" href="https://v2.vuejs.org/js/vue.min.js">https://v2.vuejs.org/js/vue.min.js</a></p>
<p>Vue.js：<a target="_blank" rel="noopener" href="https://v2.vuejs.org/js/vue.js">https://v2.vuejs.org/js/vue.js</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1、引入js文件的标签必须是双标签，不能是自结束标签 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        错误： &lt;script src=&quot;../js//vue.min.js&quot;/&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 2、script 标签引入 js 文件后不能在中间编写代码 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js//vue.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>创建 vue 对象</li>
<li>使用 div 标签和它的 id 属性指定 vue 控制的区域使用 div 标签和它的 id 属性指定 vue 控制的区域</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    &#123;&#123;message&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;&#123;message&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>, <span class="comment">// 指定 vue 控制的区域</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">message</span>: <span class="string">&quot;hello world&quot;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hello world</span><br><span class="line">&#123;&#123;message&#125;&#125;</span><br></pre></td></tr></table></figure>



<p>vue  有一套固定的代码段，可以配置 vscode 的代码片段：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	<span class="attr">&quot;vue htm&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">		<span class="attr">&quot;scope&quot;</span><span class="punctuation">:</span> <span class="string">&quot;html&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;prefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vuehtml&quot;</span><span class="punctuation">,</span> <span class="comment">// 快捷键</span></span><br><span class="line">		<span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">			<span class="string">&quot;&lt;!DOCTYPE html&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;&lt;html lang=\&quot;en\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;&lt;head&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;    &lt;meta charset=\&quot;UTF-8\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;    &lt;meta name=\&quot;viewport\&quot; content=\&quot;width=device-width, initial-scale=1.0\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;    &lt;meta http-equiv=\&quot;X-UA-Compatible\&quot; content=\&quot;ie=edge\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;    &lt;title&gt;Document&lt;/title&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;&lt;/head&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;&lt;body&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;    &lt;div id=\&quot;app\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;    &lt;/div&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;    &lt;script src=\&quot;vue.min.js\&quot;&gt;&lt;/script&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;    &lt;script&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;        new Vue(&#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;            el: &#x27;#app&#x27;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;            data: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;                $1&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;            &#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;        &#125;)&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;    &lt;/script&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;&lt;/body&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="string">&quot;&lt;/html&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;my vue template in html&quot;</span></span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<p>vue 指令：</p>
<ol>
<li>v-bind：数据的单向绑定，可以简写为一个冒号:</li>
<li>v-model：数据的双向绑定</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    &#123;&#123;username&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">v-model:value</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">v-bind:value</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;vue.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">username</span>: <span class="string">&quot;adas&quot;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>v-on：事件绑定，可以简写为艾特号 @</p>
</li>
<li><p>v-if、v-show：v-if 可以和 v-else v-else-if 配合使用</p>
</li>
<li><p>v-text：与插值表达式（两个大括号）不同，只输出绑定的值</p>
</li>
<li><p>v-for：</p>
</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;obj, index in objs&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123;index&#125;&#125;  --  &#123;&#123;obj.username&#125;&#125;  --  &#123;&#123;obj.age&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;vue.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">objs</span>: [</span></span><br><span class="line"><span class="language-javascript">                &#123;<span class="attr">username</span>: <span class="string">&quot;xiaoming&quot;</span>, <span class="attr">age</span>: <span class="number">12</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123;<span class="attr">username</span>: <span class="string">&quot;David&quot;</span>, <span class="attr">age</span>: <span class="number">13</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123;<span class="attr">username</span>: <span class="string">&quot;daming&quot;</span>, <span class="attr">age</span>: <span class="number">14</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123;<span class="attr">username</span>: <span class="string">&quot;kkk&quot;</span>, <span class="attr">age</span>: <span class="number">15</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123;<span class="attr">username</span>: <span class="string">&quot;q&quot;</span>, <span class="attr">age</span>: <span class="number">16</span>&#125;</span></span><br><span class="line"><span class="language-javascript">            ]</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-3-Vue-组件"><a href="#2-3-Vue-组件" class="headerlink" title="2.3  Vue 组件"></a>2.3  Vue 组件</h4><p>在 js 文件中编写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="property">components</span>: &#123;<span class="string">&quot;aaa&quot;</span>: </span><br><span class="line">	&#123;<span class="attr">template</span>: <span class="string">&quot;&lt;h1&gt;计算机&lt;/h1&gt;&quot;</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 html 里编写</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aaa</span>/&gt;</span> <span class="comment">&lt;!-- 这里会显示自定义组件的东西 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;vue.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;demo.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-4-Vue-生命周期"><a href="#2-4-Vue-生命周期" class="headerlink" title="2.4  Vue 生命周期"></a>2.4  Vue 生命周期</h4><p>Vue 生命周期最重要的是 create 和 mount 两个过程：</p>
<ul>
<li>create 是在渲染数据之前</li>
<li>mount 是在渲染数据之后</li>
</ul>
<p>所以，当前端页面有列表需要显示数据的时候，都把查询后端 url 的方法写在 created 钩子函数里面，通过 debugger 证明：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123;message&#125;&#125;        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;vue.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">message</span>: <span class="string">&quot;hello, world&quot;</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;created method&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">debugger</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">debugger</span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;mounted method&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/./%E3%80%8A%E5%B0%9A%E5%8C%BB%E9%80%9A%E3%80%8B%E7%AC%94%E8%AE%B0/vue%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.png" alt="image-20221024153630765"></p>
<h4 id="2-5-Vue-路由"><a href="#2-5-Vue-路由" class="headerlink" title="2.5 Vue 路由"></a>2.5 Vue 路由</h4><p>Vue router 基于 Vue 编写，所以引入 router 前需要先引入 Vue</p>
<p>1、先引入 router 的 js 文件：</p>
<p>vue-router.min.js：<a target="_blank" rel="noopener" href="https://unpkg.com/vue-router@3.5.1/dist/vue-router.min.js">https://unpkg.com/vue-router@3.5.1/dist/vue-router.min.js</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;vue.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;vue-router.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、在 script 标签中创建 Vue 对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;</span><br><span class="line">    <span class="attr">routes</span>: [</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>, <span class="attr">redirect</span>: <span class="string">&quot;/t&quot;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">&quot;/t&quot;</span>, <span class="attr">component</span>: &#123;<span class="attr">template</span>: <span class="string">&quot;&lt;div&gt;teacher&lt;/div&gt;&quot;</span>&#125; &#125;,</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">&quot;/s&quot;</span>, <span class="attr">component</span>: &#123;<span class="attr">template</span>: <span class="string">&quot;&lt;div&gt;student&lt;/div&gt;&quot;</span>&#125; &#125;,</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">&quot;/o&quot;</span>, <span class="attr">component</span>: &#123;<span class="attr">template</span>: <span class="string">&quot;&lt;div&gt;other&lt;/div&gt;&quot;</span>&#125; &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    router</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>3、在 html 中编写 router-link 编码路由地址和 router-view 显示路由页面：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span>&gt;</span>teacher<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/t&quot;</span>&gt;</span>teacher<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/s&quot;</span>&gt;</span>student<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/o&quot;</span>&gt;</span>other<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3、Axios"><a href="#3、Axios" class="headerlink" title="3、Axios"></a>3、Axios</h3><p>1、Axios 基于 Vue 编写，所以引入 axios 前同样需要先引入 vue</p>
<p>axios.js：<a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js">https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;vue.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;axios.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、在需要 axios 的地方调用 axios 里的 get、post 等方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">userList</span>: []</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    axios.<span class="title function_">get</span>(<span class="string">&quot;data.json&quot;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">item</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">userList</span> = item.<span class="property">data</span>.<span class="property">data</span>.<span class="property">items</span>;</span><br><span class="line">    &#125;).<span class="title function_">catch</span>().<span class="title function_">finally</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3、获得数据后进行渲染：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;user in userList&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123;user.name&#125;&#125; || &#123;&#123;user.age&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4、element-UI"><a href="#4、element-UI" class="headerlink" title="4、element-UI"></a>4、element-UI</h3><p>1、element-UI 基于 Vue 编写，所以引入 element-UI 前同样需要先引入 vue</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 引入样式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://unpkg.com/element-ui/lib/theme-chalk/index.css&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引入组件库 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/element-ui/lib/index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、化身 element-ui 官网 cv 工程师</p>
<h3 id="5、Node"><a href="#5、Node" class="headerlink" title="5、Node"></a>5、Node</h3><ol>
<li>Node.js 基于 Google 的 V8 引擎，是一个事件驱动的 JavaScript 环境，速度快，性能好，可以解析或者运行 js 文件</li>
</ol>
<p>直接使用 node 命令运行 js 文件：</p>
<ul>
<li>在 1.js 文件中编写内容：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hello world&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>cmd 控制台使用 node 命令：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS D:\Developer\Codespace\Vscode\js&gt; node 1.js</span><br><span class="line">hello world</span><br></pre></td></tr></table></figure>



<ol start="2">
<li>可以部署应用，充当前端服务器</li>
</ol>
<ul>
<li>在 1.js 文件中编写内容：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"></span><br><span class="line">http.<span class="title function_">createServer</span>(<span class="keyword">function</span> (<span class="params">request, response</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 发送 HTTP 头部 </span></span><br><span class="line">    <span class="comment">// HTTP 状态值: 200 : OK</span></span><br><span class="line">    <span class="comment">// 内容类型: text/plain</span></span><br><span class="line">    response.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/plain&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 发送响应数据 &quot;Hello World&quot;</span></span><br><span class="line">    response.<span class="title function_">end</span>(<span class="string">&#x27;Hello World\n&#x27;</span>);</span><br><span class="line">&#125;).<span class="title function_">listen</span>(<span class="number">8080</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 终端打印如下信息</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server running at http://127.0.0.1:8080/&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>cmd 控制台使用 node 命令启动服务：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS D:\Developer\Codespace\Vscode\js&gt; node 1.js</span><br><span class="line">Server running at http://127.0.0.1:8080/</span><br></pre></td></tr></table></figure>

<h3 id="6、NPM（node-package-manager）"><a href="#6、NPM（node-package-manager）" class="headerlink" title="6、NPM（node package manager）"></a>6、NPM（node package manager）</h3><p>创建文件夹 npm，进入该文件夹后执行 npm init 后会生成 package.json：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;npm&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;npm 入门&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;deepchieh&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ISC&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>npm 常用命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">npm install						 <span class="comment"># 可以快速安装 package.json 中的依赖</span></span><br><span class="line">npm install -g 或者 --gloabal		<span class="comment"># 全局安装</span></span><br><span class="line">npm install -d 或者 --save-dev	<span class="comment"># 只在开发的时候使用，比如语法检查插件</span></span><br><span class="line">npm update</span><br><span class="line">npm update -g 或者 --global</span><br><span class="line">npm uninstall</span><br><span class="line">npm uninstall -g 或者 --global</span><br></pre></td></tr></table></figure>

<p>npm 配置镜像：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 经过下面的配置，以后所有的 npm install 都会经过淘宝的镜像地址下载</span></span><br><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org </span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看npm配置信息</span></span><br><span class="line">npm config list</span><br></pre></td></tr></table></figure>

<h3 id="7、Babel"><a href="#7、Babel" class="headerlink" title="7、Babel"></a>7、Babel</h3><p>Babel 可以将 es6 标准的代码转换成 es5 标准</p>
<p>1、安装 Babel：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g babel-cli</span><br></pre></td></tr></table></figure>

<p>2、安装转码器：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev babel-preset-es2015</span><br></pre></td></tr></table></figure>

<p>3、创建 .babelrc 文件</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;presets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;es2015&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;plugins&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>4、编写 es6 代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line">arr = arr.<span class="title function_">map</span>(<span class="function"><span class="params">item</span>=&gt;</span>&#123;item+<span class="number">1</span>&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr);</span><br></pre></td></tr></table></figure>

<p>5、使用 babel 命令生成 es5 代码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">babel 源文件 -o 目标文件</span><br><span class="line"><span class="comment"># 或者：babel 源文件夹 -d 目标文件夹</span></span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">arr = arr.<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">item</span>) &#123;</span><br><span class="line">  item + <span class="number">1</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr);</span><br></pre></td></tr></table></figure>

<h3 id="8、模块化"><a href="#8、模块化" class="headerlink" title="8、模块化"></a>8、模块化</h3><p>从一个 js 文件引用另一个 js 文件里的代码，关键字：</p>
<ul>
<li>es5：<ul>
<li>module.exports</li>
<li>require(“xxx.js”);</li>
</ul>
</li>
<li>练习：</li>
</ul>
<p>1.js 文件内容：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这些方法类似于 Java 中的 private</span></span><br><span class="line"><span class="keyword">var</span> add = <span class="keyword">function</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseInt</span>(a) + <span class="built_in">parseInt</span>(b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> sub = <span class="keyword">function</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseInt</span>(a) - <span class="built_in">parseInt</span>(b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> mul = <span class="keyword">function</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseInt</span>(a) * <span class="built_in">parseInt</span>(b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> div = <span class="keyword">function</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseInt</span>(a) / <span class="built_in">parseInt</span>(b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">add</span>: add, </span><br><span class="line">    <span class="attr">sub</span>: sub, </span><br><span class="line">    <span class="attr">mul</span>: mul,</span><br><span class="line">    <span class="attr">div</span>: div</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.js 文件内容：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cal = <span class="built_in">require</span>(<span class="string">&quot;./calculate.js&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hello &quot;</span> + cal.<span class="title function_">add</span>(<span class="number">1</span>, <span class="number">3</span>));</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS D:\Developer\Codespace\Vscode\模块化\es5&gt; node write.js</span><br><span class="line">hello 4</span><br></pre></td></tr></table></figure>



<ul>
<li>es6（node 不支持）<ul>
<li>export</li>
<li>import</li>
</ul>
</li>
<li>练习：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一个一个地导出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">sub</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseInt</span>(a) - <span class="built_in">parseInt</span>(b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全部导出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">	add</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="9、webpack"><a href="#9、webpack" class="headerlink" title="9、webpack"></a>9、webpack</h3><p>一个资源打包工具，比如 vue.js 和 vue.min.js，webpack 可以把 js 文件压缩成一个 js 文件，方便用户获取</p>
<p>一个作用：一个 js 文件引用多个 js 文件里的内容，webpack 可以把这些内容打包进一个文件里面</p>
<p>还有一个作用：打包多个 css 到一个文件里</p>
<p>先说打包多个 js 文件的方法：</p>
<p>1、安装 webpack 和 webpack-cli：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g webpack webpack-cli</span><br></pre></td></tr></table></figure>

<p>2、编写 js 配置文件 <strong>webpack.config.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>); <span class="comment">//Node.js内置模块</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/main.js&#x27;</span>, <span class="comment">//配置入口文件</span></span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;./dist&#x27;</span>), <span class="comment">//输出路径，__dirname：当前文件所在路径</span></span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span> <span class="comment">//输出文件</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3、编写代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 01.js 文件</span></span><br><span class="line"><span class="keyword">var</span> write = <span class="keyword">function</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(str);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">write</span>: write</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 02.js 文件</span></span><br><span class="line"><span class="keyword">var</span> write = <span class="keyword">function</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseInt</span>(a) + <span class="built_in">parseInt</span>(b)</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">export</span> = &#123;</span><br><span class="line">    <span class="attr">write</span>: write</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js 文件</span></span><br><span class="line"><span class="keyword">var</span> obj1 = <span class="built_in">require</span>(<span class="string">&quot;./01&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> obj2 = <span class="built_in">require</span>(<span class="string">&quot;./02&quot;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hello webpak&quot;</span>);</span><br><span class="line">obj1.<span class="title function_">write</span>(obj2.<span class="title function_">write</span>(<span class="number">1</span>, <span class="number">5</span>)) </span><br></pre></td></tr></table></figure>

<p>4、使用 webpack 命令生成打包 js 文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webpack --mode=production</span><br></pre></td></tr></table></figure>

<p>5、结果：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bundle.js 文件</span></span><br><span class="line">(<span class="function">()=&gt;</span>&#123;<span class="keyword">var</span> r,e,t=&#123;<span class="number">81</span>:<span class="function"><span class="params">r</span>=&gt;</span>&#123;r.<span class="property">exports</span>=&#123;<span class="attr">write</span>:<span class="keyword">function</span>(<span class="params">r</span>)&#123;<span class="variable language_">document</span>.<span class="title function_">write</span>(r)&#125;&#125;&#125;,<span class="number">623</span>:<span class="function"><span class="params">r</span>=&gt;</span>&#123;r.<span class="property">exports</span>=&#123;<span class="attr">add</span>:<span class="keyword">function</span>(<span class="params">r,e</span>)&#123;<span class="keyword">return</span> <span class="built_in">parseInt</span>(r)+<span class="built_in">parseInt</span>(e)&#125;&#125;&#125;&#125;,o=&#123;&#125;;<span class="keyword">function</span> <span class="title function_">n</span>(<span class="params">r</span>)&#123;<span class="keyword">var</span> e=o[r];<span class="keyword">if</span>(<span class="keyword">void</span> <span class="number">0</span>!==e)<span class="keyword">return</span> e.<span class="property">exports</span>;<span class="keyword">var</span> p=o[r]=&#123;<span class="attr">exports</span>:&#123;&#125;&#125;;<span class="keyword">return</span> t[r](p,p.<span class="property">exports</span>,n),p.<span class="property">exports</span>&#125;r=<span class="title function_">n</span>(<span class="number">81</span>),e=<span class="title function_">n</span>(<span class="number">623</span>),<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hello webpak&quot;</span>),r.<span class="title function_">write</span>(e.<span class="title function_">add</span>(<span class="number">1</span>,<span class="number">5</span>))&#125;)();</span><br></pre></td></tr></table></figure>

<p>6、在 html 文件中编写引入 bundle.js 文件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>打包多个 css：</p>
<p>1、安装 css-loader 和 style-loader：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save-dev style-loader css-loader</span><br></pre></td></tr></table></figure>

<p>2、为了方便使用 npm 命令，修改 package.json 文件：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack --mode=development&quot;</span> <span class="comment">// 添加的一行代码</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>3、webpack.config.js 文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>); <span class="comment">//Node.js内置模块</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/main.js&#x27;</span>, <span class="comment">//配置入口文件</span></span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;./dist&#x27;</span>), <span class="comment">//输出路径，__dirname：当前文件所在路径</span></span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span> <span class="comment">//输出文件</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="comment">// 打包规则应用到以 css 结尾的文件中</span></span><br><span class="line">                <span class="attr">use</span>: [<span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span>]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4、修改源代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// style<span class="selector-class">.css</span> 文件</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>:pink;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// <span class="selector-tag">main</span><span class="selector-class">.js</span> 文件添加下面的代码</span><br><span class="line">require(&#x27;./style<span class="selector-class">.css</span>&#x27;);</span><br></pre></td></tr></table></figure>

<p>5、执行打包命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<h2 id="十、Vue-脚手架"><a href="#十、Vue-脚手架" class="headerlink" title="十、Vue 脚手架"></a>十、Vue 脚手架</h2><h3 id="1、Vue-element-admin"><a href="#1、Vue-element-admin" class="headerlink" title="1、Vue-element-admin"></a>1、Vue-element-admin</h3><p> Vue-element-admin 是一个后台前端解决方案，使用 <em>vue</em>、vuex、<em>vue</em>-router、<em>element</em> 等前端前沿技术开发的框架</p>
<p>在线演示地址：<a target="_blank" rel="noopener" href="https://panjiachen.gitee.io/vue-element-admin/#/guide/index">https://panjiachen.gitee.io/vue-element-admin/#/guide/index</a></p>
<h3 id="2、Vue-admin-template"><a href="#2、Vue-admin-template" class="headerlink" title="2、Vue-admin-template"></a>2、Vue-admin-template</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://chanjechieh.github.io/2022/09/26/%E3%80%8A%E5%B0%9A%E5%8C%BB%E9%80%9A%E3%80%8B%E7%AC%94%E8%AE%B0/" data-id="clwn8c9f7000gp4shhxib2gbu" data-title="《尚医通》笔记" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-JVM" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/08/23/JVM/" class="article-date">
  <time class="dt-published" datetime="2022-08-23T07:55:29.000Z" itemprop="datePublished">2022-08-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/08/23/JVM/">JVM</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="需要掌握的知识（实践少、理论为主）"><a href="#需要掌握的知识（实践少、理论为主）" class="headerlink" title="需要掌握的知识（实践少、理论为主）"></a>需要掌握的知识（实践少、理论为主）</h2><p>JVM 的知识、JVM 的体系结构、类加载器、双亲委派机制、沙箱安全机制、Native、PC 寄存器、方法区、栈、三种 JVM、堆、新生区、老年区、永久区、堆内存调优、GC、JMM</p>
<h2 id="一、JVM-的体系结构"><a href="#一、JVM-的体系结构" class="headerlink" title="一、JVM 的体系结构"></a>一、JVM 的体系结构</h2><p>JVM 在 OS 上面（Java 又叫 C++–），在 Java 应用程序下面</p>
<p>Java 文件需要经过的步骤：</p>
<ol>
<li>先通过 javac 命令编译成 class 文件</li>
<li>类装载器将类装载到 JVM 里面（Runtime Data Area：运行时数据区、Method Area：方法区、Stack：Java 栈、Heap：堆、Native Method Stack：本地方法栈、程序计数器）</li>
</ol>
<p>JVM  的简易图：</p>
<p><img src="/1.jpg" alt="1"></p>
<ul>
<li><p>垃圾回收：因为垃圾回收不会在 Java 栈、程序计数器 和 本地方法栈里存在，所以 JVM 调优一般都是调 堆（重点）和 方法区</p>
</li>
<li><p>类加载器：加载类文件，对应 new Student()</p>
<ul>
<li>加载出来的具体实例存放在 堆 里面</li>
<li>而它的引用放在 栈（栈就是用来存引用地址的，程序通过地址去堆里找具体的元素） 里面</li>
<li>以 Car 类为例：<ul>
<li>生成 class 文件后，由 Class Loader 加载进 JVM （类是抽象的，对象是具体的）</li>
</ul>
</li>
<li>分类：<ul>
<li>虚拟机自带的加载器</li>
<li>启动类（根）加载器</li>
<li>扩展类加载器</li>
<li>应用程序（系统类）加载器</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/JVM.jpg" alt="JVM"></p>
<h2 id="二、类加载器和双亲委派机制"><a href="#二、类加载器和双亲委派机制" class="headerlink" title="二、类加载器和双亲委派机制"></a>二、类加载器和双亲委派机制</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://chanjechieh.github.io/2022/08/23/JVM/" data-id="clwn8c9eu0000p4sh69c6dtye" data-title="JVM" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-算法：从入门到入土" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/19/%E7%AE%97%E6%B3%95%EF%BC%9A%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/" class="article-date">
  <time class="dt-published" datetime="2022-07-19T02:52:50.000Z" itemprop="datePublished">2022-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/19/%E7%AE%97%E6%B3%95%EF%BC%9A%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/">算法：从入门到入土</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>目录：</p>
<p>[toc]</p>
<h1 id="一、新手"><a href="#一、新手" class="headerlink" title="一、新手"></a>一、新手</h1><h2 id="1、二进制"><a href="#1、二进制" class="headerlink" title="1、二进制"></a>1、二进制</h2><p>关于二进制，使用补码表示： 以int 整型数字在计算机底层表示中，第一位是符号位，0 和 1 分别表示这个数字是正数和负数 </p>
<h3 id="1-1-位运算"><a href="#1-1-位运算" class="headerlink" title="1.1 位运算"></a>1.1 位运算</h3><p>位运算包括左移和右移，它们的作用分别是：</p>
<ul>
<li>左移（&lt;&lt;）：数字的二进制表示右侧添零，左侧删除（相当于乘了左移步数次 2）</li>
<li>右移：同理，但结果相反<ul>
<li>带符号右移（&gt;&gt;）：……</li>
<li>不带符号右移（&gt;&gt;&gt;）：……</li>
</ul>
</li>
<li>或（|）：……</li>
<li>与（&amp;）：……</li>
<li>异或（^）：相同为 0，不同为 1</li>
</ul>
<h3 id="1-2-补码"><a href="#1-2-补码" class="headerlink" title="1.2 补码"></a>1.2 补码</h3><ul>
<li>补码的存在方便计算机进行运算</li>
<li>负数的补码是在原码的基础上，取反后加 1：所以一个数 num 的相反数可以用 (~num + 1)来表示</li>
<li>观察下面的表示可以知道：0 开头的二进制表示包括 0 和非负数，而 1 开头的二进制表示里只有负数，这就是为什么整型最大值的绝对值和最小值的绝对值相差 1 的原因：  <ul>
<li>补码中的最大值：01111111111111111111111111111111  </li>
<li>补码中的最小值：10000000000000000000000000000000  </li>
<li>补码中的零：00000000000000000000000000000000</li>
</ul>
</li>
</ul>
<h3 id="1-3-Question：打印一个数字的-32-位二进制表示"><a href="#1-3-Question：打印一个数字的-32-位二进制表示" class="headerlink" title="1.3 Question：打印一个数字的 32 位二进制表示"></a>1.3 Question：打印一个数字的 32 位二进制表示</h3><p>解题思路：</p>
<ol>
<li>整型变脸在计算机底层由 32 位二进制数字组成（长整型为 64 位）</li>
<li>对两个整型数进行与运算，实际就是将两个数的 32 位二进制表示逐位进行与运算</li>
<li>根据上面的知识可知：将 1 左移 n 位得到的数字与待求数字做与运算得到的结果如果是 0，证明待求数字在低位 n+1 位的表示为 0，否则为 1（但不能根据结果是否为 1 来判断低位 n+1 位是否为 1）</li>
</ol>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">myPrint</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">31</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            System.out.print((num &amp; (<span class="number">1</span> &lt;&lt; i)) == <span class="number">0</span> ? <span class="string">&quot;0&quot;</span> : <span class="string">&quot;1&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            myPrint(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="2、排序"><a href="#2、排序" class="headerlink" title="2、排序"></a>2、排序</h2><p>介绍三种排序：选择排序、冒泡排序、插入排序，三种排序都用到一个 swap 函数：</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> arr[i];</span><br><span class="line">    arr[i] = arr[j];</span><br><span class="line">    arr[j] = t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-1-Question：选择排序"><a href="#2-1-Question：选择排序" class="headerlink" title="2.1 Question：选择排序"></a>2.1 Question：选择排序</h3><p>选择排序：每次选最小的数字放在当前数组（从 i 到 n-1 位置，i 的取值范围为 0 到 n-1 ）的最前面</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">selectSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length &lt; <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> arr.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">minValueIndex</span> <span class="operator">=</span> i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i; j &lt; N; j++) &#123;</span><br><span class="line">            minValueIndex = arr[j] &lt; arr[minValueIndex] ? j : minValueIndex;</span><br><span class="line">        &#125;</span><br><span class="line">        swap(arr, i, minValueIndex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-2-Question：冒泡排序"><a href="#2-2-Question：冒泡排序" class="headerlink" title="2.2 Question：冒泡排序"></a>2.2 Question：冒泡排序</h3><p>冒泡排序：每次比较待排序数组（从 0 到 end，end 的取值范围为 n-1 到 1）中相邻元素的大小，如果前一个比后一个大，就交换</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">bubbleSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> arr.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> N-<span class="number">1</span>; end &gt;= <span class="number">0</span>; end--)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">second</span> <span class="operator">=</span> <span class="number">1</span>; second &lt;= end; second ++)</span><br><span class="line">            <span class="keyword">if</span> ( arr[second-<span class="number">1</span>] &gt; arr[second] )</span><br><span class="line">                swap(arr, second-<span class="number">1</span>, second);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-3-Question：插入排序"><a href="#2-3-Question：插入排序" class="headerlink" title="2.3 Question：插入排序"></a>2.3 Question：插入排序</h3><p>插入排序：模拟打牌，i 往后的都是新牌，每次把一张牌插入到已经排序好的数组（0 到 i 位置）中，直到整个数组有序</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">insertSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length &lt; <span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> arr.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> <span class="number">1</span>; end &lt; N; end++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">pre</span> <span class="operator">=</span> end-<span class="number">1</span>; pre &gt;= <span class="number">0</span> &amp;&amp; arr[pre] &gt; arr[pre+<span class="number">1</span>]; pre--)</span><br><span class="line">            swap(arr, pre, pre+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="3、Question：数组指定范围区间数字的和（前缀和）"><a href="#3、Question：数组指定范围区间数字的和（前缀和）" class="headerlink" title="3、Question：数组指定范围区间数字的和（前缀和）"></a>3、Question：数组指定范围区间数字的和（前缀和）</h2><p>背景：</p>
<p>假设这个操作会被频繁地使用</p>
<p>思路：</p>
<p>利用辅助数组前缀和数组（什么是前缀和数组？如果一个数组 arr，值为  {1, 2, 3, 4, 5}，那么其前缀和数组为 {1, 3, 6, 10, 15}，用公式表示：help[cur] &#x3D; help[pre] + arr[cur]，其中 help 就是前缀和数组）</p>
<p>代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RangeSum</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] help;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RangeSum</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> arr.length;</span><br><span class="line">        help = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">        help[<span class="number">0</span>] = arr[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="number">0</span>; pre &lt; N-<span class="number">1</span>; pre++)</span><br><span class="line">            help[pre + <span class="number">1</span>] = help[pre] + arr[pre + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">rangeSum</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> l == <span class="number">0</span> ? help[r] : help[r] - help[l-<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="4、对数器"><a href="#4、对数器" class="headerlink" title="4、对数器"></a>4、对数器</h2><p>Java 有一个方法 Math.random() 可以等概率返回 0 到 1 之间的小数，也就是说： Math.random() 返回的小数在 0 到 x 之间的概率为 x</p>
<p>三个相关问题：</p>
<ul>
<li>从 1-5 随机到 1-7 随机</li>
<li>从 a-b 随机到 c-d 随机</li>
<li>01 不等概率随机到 01 等概率随机</li>
</ul>
<h3 id="4-1-Question：设计函数，返回的小数在-0-到-x-之间的概率为-x-2"><a href="#4-1-Question：设计函数，返回的小数在-0-到-x-之间的概率为-x-2" class="headerlink" title="4.1 Question：设计函数，返回的小数在 0 到 x 之间的概率为 x^2"></a>4.1 Question：设计函数，返回的小数在 0 到 x 之间的概率为 x^2</h3><p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">double</span> <span class="title function_">xToXPower2</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Math.max(Math.random(), Math.random());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>解释：</p>
<ul>
<li>函数 xToXPower2 通过返回两次 random 结果的最大值来实现返回的数字在 0 到 x 之间的概率为 x^2</li>
<li>只有两次 random 函数返回的结果都位于 0 到 x 之间（如果有一个结果大于 x，根据 max 函数的性质，返回的结果就会位于 x 到 1 之间），才能满足最后的结果也位于 0 到 x 之间</li>
<li>因为 “两次 random 函数返回数字位于 0 到 x 之间” 可以视为两个独立事件，所以其同时发生的概率为 x^2</li>
</ul>
<p>扩展：</p>
<p>Q：怎么使这个概率为 x^3？<br>A：调用三次 random 函数后，取最大值（三次独立事件同时发生的概率）</p>
<h3 id="4-2-Question：等概率得到-0-到-7-八个数字"><a href="#4-2-Question：等概率得到-0-到-7-八个数字" class="headerlink" title="4.2 Question：等概率得到 0 到 7 八个数字"></a>4.2 Question：等概率得到 0 到 7 八个数字</h3><p>题目：</p>
<p>有一个黑盒方法 f1()，这个方法可以等概率返回 1，2，3，4，5 其中一个数字，要求编写一个函数 g()，这个函数可以等概率返回 1，2，3，4，5，6，7 其中一个数字。</p>
<p>思路：</p>
<ol>
<li>使用函数 f1() 构造 01 等概率生成函数 f2()，当 f1() 返回的结果是 3 时 “再来一次”，大于 3 时返回 1，小于 3 时返回 0</li>
<li>调用三次 f2() 分别生成三位二进制数的三个数字，使得 f3() 可以等概率输出 0，1，2，3，4，5，6，7 八个数字</li>
<li>当函数 f3() 函数输出的结果为 7 时重来一次，让 f4() 可以等概率输出 0，1，2，3，4，5，6 七个数字</li>
<li>在函数 f3() 得到结果上加一，即目标函数 g()</li>
</ol>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">f1</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">randNum</span> <span class="operator">=</span> (<span class="type">int</span>)(Math.random() * <span class="number">5</span> + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> randNum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">f2</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        ret = f1();</span><br><span class="line">    &#125; <span class="keyword">while</span> (ret == <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">return</span> ret &gt; <span class="number">3</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">f3</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">d0</span> <span class="operator">=</span> f2();</span><br><span class="line">    <span class="type">int</span> <span class="variable">d1</span> <span class="operator">=</span> f2() &lt;&lt; <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">d2</span> <span class="operator">=</span> f2() &lt;&lt; <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">ret</span> <span class="operator">=</span> d0 + d1 + d2;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">f4</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        ret = f3();</span><br><span class="line">    &#125; <span class="keyword">while</span> (ret == <span class="number">7</span>);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">g</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> f4() + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-Question：不等概率-01-随机到等概率-01-随机"><a href="#4-3-Question：不等概率-01-随机到等概率-01-随机" class="headerlink" title="4.3 Question：不等概率 01 随机到等概率 01 随机"></a>4.3 Question：不等概率 01 随机到等概率 01 随机</h3><p>思路：</p>
<p>假设生成 0 的概率为 p，生成 1 的概率为 1-p，设置一个两位二进制数字，有下面四种情况：</p>
<ul>
<li>00：概率为 p^2</li>
<li>01：概率为 p(1-p)</li>
<li>10：概率为 (1-p)p</li>
<li>11：概率为 (1-p)^2</li>
</ul>
<p>发现生成 01 和 10 的概率是相同的，可以设置函数在遇到 01 的时候返回 0，遇到 10 的时候返回 1，剩下两种情况重做。</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">x</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Math.random() &gt; <span class="number">0.84</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">y</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        ans = x();</span><br><span class="line">    &#125; <span class="keyword">while</span> (ans == x());</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="4-4-实现对数器"><a href="#4-4-实现对数器" class="headerlink" title="4.4 实现对数器"></a>4.4 实现对数器</h3><p>对数器是通过用大量随机的测试数据来验证算法是否正确的一种方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">insertSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> arr.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> <span class="number">1</span>; end &lt; N; end++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">pre</span> <span class="operator">=</span> end-<span class="number">1</span>; pre &gt;= <span class="number">0</span> &amp;&amp; arr[pre] &gt; arr[pre+<span class="number">1</span>]; pre--) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> arr[pre];</span><br><span class="line">            arr[pre] = arr[pre+<span class="number">1</span>];</span><br><span class="line">            arr[pre+<span class="number">1</span>] = t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[] lenRandomValueRandom(<span class="type">int</span> maxLength, <span class="type">int</span> maxValue) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> (<span class="type">int</span>) (Math.random() * maxLength);</span><br><span class="line">    <span class="type">int</span>[] arr = <span class="keyword">new</span> <span class="title class_">int</span>[len];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        arr[i] = (<span class="type">int</span>) (Math.random() * maxValue);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[] copyArray(<span class="type">int</span>[] arr) &#123;</span><br><span class="line">    <span class="type">int</span>[] ans = <span class="keyword">new</span> <span class="title class_">int</span>[arr.length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++)</span><br><span class="line">        ans[i] = arr[i];</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isSorted</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; arr.length; i++)</span><br><span class="line">        <span class="keyword">if</span> (arr[i-<span class="number">1</span>] &gt; arr[i])</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">maxLength</span> <span class="operator">=</span> <span class="number">500</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">maxValue</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">testCount</span> <span class="operator">=</span> <span class="number">1000000</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; testCount; i++) &#123;</span><br><span class="line">        <span class="type">int</span>[] arr = lenRandomValueRandom(maxLength, maxValue);</span><br><span class="line">        <span class="type">int</span>[] tmp = copyArray(arr);</span><br><span class="line">        insertSort(arr);</span><br><span class="line">        <span class="keyword">if</span> (!isSorted(arr)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; tmp.length; j++)</span><br><span class="line">                System.out.print(tmp[j] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">            System.out.println();</span><br><span class="line">            System.out.println(<span class="string">&quot;算法错误&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5、二分法"><a href="#5、二分法" class="headerlink" title="5、二分法"></a>5、二分法</h2><h3 id="5-1-二分查找"><a href="#5-1-二分查找" class="headerlink" title="5.1 二分查找"></a>5.1 二分查找</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">find</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> num)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> arr.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (L &lt;= R) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> (L + R) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (arr[mid] == num)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (arr[mid] &lt; num)</span><br><span class="line">            L = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            R = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-2-Question：有序数组找到大于等于-num-最左的位置"><a href="#5-2-Question：有序数组找到大于等于-num-最左的位置" class="headerlink" title="5.2 Question：有序数组找到大于等于 num 最左的位置"></a>5.2 Question：有序数组找到大于等于 num 最左的位置</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">mostLeftNoLessNumIndex</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> num)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>, R = arr.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (L &lt;= R) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> (L + R) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (arr[mid] &gt;= num) &#123;</span><br><span class="line">            ans = mid;</span><br><span class="line">            R = mid - <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            L = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-3-Question：有序数组找到小于等于-num-最右的位置"><a href="#5-3-Question：有序数组找到小于等于-num-最右的位置" class="headerlink" title="5.3 Question：有序数组找到小于等于 num 最右的位置"></a>5.3 Question：有序数组找到小于等于 num 最右的位置</h3><p>同上</p>
<h3 id="5-4-Question：局部最小值问题"><a href="#5-4-Question：局部最小值问题" class="headerlink" title="5.4 Question：局部最小值问题"></a>5.4 Question：局部最小值问题</h3><p>题目：有一个无序的数组，任意相邻的两个元素都不相等，编写函数，该函数返回数组中任意一个局部最小值的位置</p>
<p>局部最小值（【i】表示下标为 i 处数组的值）的定义如下：</p>
<ul>
<li>【0】 小于 【1】：0 是局部最小值</li>
<li>【n-1】 小于 【n-2】：n-1 位置的数字局部最小</li>
<li>对于其他位置 i，【i】 小于 【i-1】，并且 【i】小于【i+1】：i 位置的数字局部最小</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">oneMinIndex</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> arr.length;</span><br><span class="line">    <span class="keyword">if</span> (N == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (arr[<span class="number">0</span>] &lt; arr[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (arr[N-<span class="number">1</span>] &lt; arr[N-<span class="number">2</span>])</span><br><span class="line">        <span class="keyword">return</span> N-<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> N-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (L &lt; R-<span class="number">1</span>) &#123; <span class="comment">// 保证 L 到 R 之间大于三个数字</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> ( L + R ) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (arr[mid] &lt; arr[mid - <span class="number">1</span>] &amp;&amp; arr[mid] &lt; arr[mid + <span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (arr[mid] &gt; arr[mid - <span class="number">1</span>]) &#123;</span><br><span class="line">            R = mid - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (arr[mid] &gt; arr[mid + <span class="number">1</span>]) &#123;</span><br><span class="line">            L = mid + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr[L] &lt; arr[R] ? L : R;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> minIndex)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr.length == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> minIndex == -<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> minIndex - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> minIndex + <span class="number">1</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">leftBigger</span> <span class="operator">=</span> left &lt; <span class="number">0</span> || arr[left] &gt; arr[minIndex];</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">rightBigger</span> <span class="operator">=</span> right &gt; arr.length - <span class="number">1</span> || arr[right] &gt; arr[minIndex];</span><br><span class="line">    <span class="keyword">return</span> leftBigger &amp;&amp; rightBigger;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">printArray</span><span class="params">(<span class="type">int</span>[] arr)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        System.out.print(arr[i] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">maxLen</span> <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">maxValue</span> <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">testNum</span> <span class="operator">=</span> <span class="number">10000</span>;</span><br><span class="line">    System.out.println(<span class="string">&quot;start&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; testNum; i++) &#123;</span><br><span class="line">        <span class="type">int</span>[] arr = randomArray(maxLen, maxValue);</span><br><span class="line">        <span class="type">int</span> <span class="variable">minIndex</span> <span class="operator">=</span> oneMinIndex(arr);</span><br><span class="line">        <span class="keyword">if</span> ( !check(arr, minIndex) ) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;minIndex: &quot;</span> + minIndex);</span><br><span class="line">            printArray(arr);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">&quot;end&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6、时间复杂度"><a href="#6、时间复杂度" class="headerlink" title="6、时间复杂度"></a>6、时间复杂度</h2><p>常数操作：计算机里面 int 类型的变量底层都是 32 位的二进制数字，所以两个整型变量之间进行加减乘除的时候，花的时间和两个整型数字的大小没有关系，这叫是常数操作（类似的还有数组根据下标取值）。</p>
<p>时间复杂度：以冒泡排序为例，假设交换两个数字这个操作称为 a 操作，那 n 个数字进行冒泡排序需要的操作次数是一个等差数列，结果为 a1*n + (n * (n-1))  &#x2F; 2  * d，最终结果为 n^2 &#x2F; 2 + n &#x2F; 2，所以这个冒泡的时间复杂度就是 O(n ^ 2)，所以时间复杂度就是一个操作的最高阶</p>
<p>对于二分操作（有序数组中找一个数，也就是一个长为 N 的数组每次切掉一半，可以切多少次），时间复杂度为 O( log N)，对数时间复杂度一般会把下标去掉，常见的时间复杂度有：O()1、O(N)、O(N log N)、O(N^2)、O(N^3)、O(2^N)、O(N!)</p>
<h2 id="7、动态数组"><a href="#7、动态数组" class="headerlink" title="7、动态数组"></a>7、动态数组</h2><h3 id="7-1-动态数组是什么？"><a href="#7-1-动态数组是什么？" class="headerlink" title="7.1 动态数组是什么？"></a>7.1 动态数组是什么？</h3><ul>
<li><p>固定长度数组：像 C 语言中定义一个数组，其长度不能改变  </p>
</li>
<li><p>动态数组：Java 中有一个 arraylist 一开始也是固定长度的数组，但是当数组长度满时，会动态申请更大的内存空间</p>
</li>
</ul>
<h3 id="7-2-动态数组的使用和扩容"><a href="#7-2-动态数组的使用和扩容" class="headerlink" title="7.2 动态数组的使用和扩容"></a>7.2 动态数组的使用和扩容</h3><p>假设一开始长度为 4，假设有新的元素来了以后：它满容装不下了，arraylist 会将它销毁并创建一个新的长度的 8 的数组，如果还是放不下会再申请一个长度为 16 的数组，以此类推</p>
<p>这时既有一个问题：arraylist 根据下标取值的时间复杂度为 O(1），但扩容操作可能会增加这个时间复杂度，这里会涉及到一个时间代价，所以动态数组要考虑时间总代价</p>
<h3 id="7-3-动态数组的扩容和时间复杂度分析"><a href="#7-3-动态数组的扩容和时间复杂度分析" class="headerlink" title="7.3 动态数组的扩容和时间复杂度分析"></a>7.3 动态数组的扩容和时间复杂度分析</h3><p>以往一个 arraylist 里加入 100 个数字为例：</p>
<ol>
<li>先加入 a 一个元素，不需要扩容</li>
<li>再加入 b 元素时，需要扩容（扩容代价为 申请一个长度为 2 的数组 + 将老数组里的 1 个元素加入新数组）</li>
<li>再加入 c 元素时，需要扩容（扩容代价为 申请一个长度为 4 的数组 + 将老数组里的 2 个元素加入新数组）</li>
<li>再加入 d, e 元素时，需要扩容（扩容代价为 申请一个长度为 8 的数组 + 将老数组里的 4 个元素加入新数组）</li>
<li>……</li>
</ol>
<p>所以，扩容总代价为  1 + 2  + 4 +  -&gt; N（大于 N 的一个数），动态数组扩容的总代价为 O(N)</p>
<p>所以，从时间复杂度来说，Java 中的 arraylist 和固定长度的数组的性能差不多</p>
<h2 id="8、哈希表和有序表"><a href="#8、哈希表和有序表" class="headerlink" title="8、哈希表和有序表"></a>8、哈希表和有序表</h2><h3 id="8-1-哈希表-O-1"><a href="#8-1-哈希表-O-1" class="headerlink" title="8.1 哈希表 O(1)"></a>8.1 哈希表 O(1)</h3><ul>
<li><p>优点：Java 中的哈希表（hashmap）无论里面存了多少元素，它的增删改查都是常数操作（但是一个常数量比较大的操作）</p>
</li>
<li><p>传递方式：Java 中 String、Integer、Float、Double 在哈希表中同意按值进行传递，但自己定义的类会按地址传入</p>
</li>
<li><p>占用空间：</p>
<ul>
<li>将 金庸 作为 key 值，倚天屠龙记的全部文字作为 value 加入 map 中，占的空间为金庸和倚天屠龙记所有文字所占的字节数为这条数据所占的字节量，</li>
<li>还是上面的例子，如果字节定义一个类，类里面有倚天屠龙记全部的文字，那这条记录所占的空间就是这个对象的地址</li>
</ul>
</li>
</ul>
<h3 id="8-2-有序表-O-logN"><a href="#8-2-有序表-O-logN" class="headerlink" title="8.2 有序表 O(logN)"></a>8.2 有序表 O(logN)</h3><p>TreeMap 内部会按照 key 排好序</p>
<ul>
<li><p>使用 firstKey()、lastKey() 取出最小和最大的 key</p>
</li>
<li><p>使用 floorKey(int)、ceilingKey(int) 取出距离传入参数最近的 key，</p>
</li>
<li><p>缺点是不能用自定义的类型</p>
</li>
</ul>
<h2 id="9、链表"><a href="#9、链表" class="headerlink" title="9、链表"></a>9、链表</h2><p>单链表：一个值，一个 last 指针</p>
<p>双俩表：一个值，一个 last 指针，一个 next 指针</p>
<h3 id="9-1-Question：链表反转："><a href="#9-1-Question：链表反转：" class="headerlink" title="9.1 Question：链表反转："></a>9.1 Question：链表反转：</h3><p>关于 Java 的知识：</p>
<ul>
<li>JVM 在内存中预设一个位置为 null，所有指向 null 的指针都指向这个区域</li>
<li>Java 中的引用：将一个对象的引用（也就是将地址拷贝一份，而不会传入真正的地址）传入一个函数</li>
</ul>
<p>单链表节点的定义：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">public</span> Node next;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> data)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>双链表节点的定义：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> DoubleNode <span class="title function_">reverseDoubleList</span><span class="params">(DoubleNode head)</span> &#123;</span><br><span class="line">    <span class="type">DoubleNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">DoubleNode</span> <span class="variable">next</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="literal">null</span>) &#123;</span><br><span class="line">        next = head.next;</span><br><span class="line">        head.next = pre;</span><br><span class="line">        head.last = next;</span><br><span class="line">        pre = head;</span><br><span class="line">        head = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pre;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>需要两个辅助指针（pre 和 next）:</p>
<ul>
<li>next：记录 head 的下一个节点，保证算法的可持续性（就是怕节点反转后找不到下一个节点没法继续反转链表了）</li>
<li>pre：记录要反转的指针要指向的节点</li>
</ul>
<p>解题方法：</p>
<ol>
<li>next 指向 head 的 next 区域，记录我要反转的下一个节点</li>
<li>head 的 next 指针指向 pre，也就是真正的反转操作</li>
<li>pre 当前节点 head，记录下一个要反转的节点要指向的目标</li>
<li>head 再指向 next。进入下一轮魂环，继续进行链表的反转</li>
</ol>
<p>对于单链表：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title function_">reverseLinkedList</span><span class="params">(Node head)</span> &#123;</span><br><span class="line">    <span class="type">Node</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">Node</span> <span class="variable">next</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="literal">null</span>) &#123;</span><br><span class="line">        next = head.next;</span><br><span class="line">        head.next = pre;</span><br><span class="line">        pre = head;</span><br><span class="line">        head = next;  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pre;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>对于双链表：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> DoubleNode <span class="title function_">reverseDoubleList</span><span class="params">(DoubleNode head)</span> &#123;</span><br><span class="line">    <span class="type">DoubleNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">DoubleNode</span> <span class="variable">next</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="literal">null</span>) &#123;</span><br><span class="line">        next = head.next;</span><br><span class="line">        head.next = pre;</span><br><span class="line">        head.last = next;</span><br><span class="line">        pre = head;</span><br><span class="line">        head = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pre;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="9-2-Question：k-个节点的组内逆序数对"><a href="#9-2-Question：k-个节点的组内逆序数对" class="headerlink" title="9.2 Question：k 个节点的组内逆序数对"></a>9.2 Question：k 个节点的组内逆序数对</h3><p>题目：给定一个单链表的头节点 head 和一个正数  k，实现 k 个节点的小组内部逆序，如果最后一组不够 k 个就不调整</p>
<p>考察代码实现能力</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ListNode</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">private</span> ListNode next;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ListNode</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">        <span class="built_in">this</span>.next = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">getKGroupEnd</span><span class="params">(ListNode start, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    <span class="keyword">while</span>( k-- != <span class="number">1</span> &amp;&amp; start != <span class="literal">null</span>) &#123;</span><br><span class="line">        start = start.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> start;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">reverse</span><span class="params">(ListNode start, ListNode end)</span> &#123;</span><br><span class="line">    end = end.next;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">next</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">while</span> (start != end) &#123;</span><br><span class="line">        next = start.next;</span><br><span class="line">        cur.next = pre;</span><br><span class="line">        pre = cur;</span><br><span class="line">        cur = next;</span><br><span class="line">    &#125;</span><br><span class="line">    start.next = end;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">reverseKGroup</span><span class="params">(ListNode head, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">start</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">end</span> <span class="operator">=</span> getKGroupEnd(start, k);</span><br><span class="line">    <span class="keyword">if</span>( end == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    head = end;</span><br><span class="line">    reverse(start, end);</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">lastEnd</span> <span class="operator">=</span> start;</span><br><span class="line">    <span class="keyword">while</span> (lastEnd.next != <span class="literal">null</span>) &#123;</span><br><span class="line">        start = lastEnd.next;</span><br><span class="line">        end = reverseKGroup(start, k);</span><br><span class="line">        <span class="keyword">if</span>(end == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        reverse(start, end);</span><br><span class="line">        lastEnd.next = end;</span><br><span class="line">        lastEnd = start;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="9-3-Question：两个链表相加"><a href="#9-3-Question：两个链表相加" class="headerlink" title="9.3 Question：两个链表相加"></a>9.3 Question：两个链表相加</h3><p>给定两个链表的头节点 head1 和 head2，认为从左到右是某个数字从低位到高位，返回相加之后的链表</p>
<p>第一步：分别找到长的链表的短的链表</p>
<p>第二步：设置一个临时变量 carry 记录是否进位，三种情况：</p>
<ul>
<li>L 和 S 都不为空时：同时遍历，L.value + S.value + carry</li>
<li>S 为空，L 为空时：遍历长链表，L.value + carry</li>
<li>L、S 都为空时：检查 carry 为 1 的话，最后加上一个值为 1 的节点</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ListNode</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">private</span> ListNode next;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ListNode</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">        <span class="built_in">this</span>.next = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">listLength</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="literal">null</span>) &#123;</span><br><span class="line">        head = head.next;</span><br><span class="line">        len ++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> len;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">addTwoNumbers</span><span class="params">(ListNode head1, ListNode head2)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">len1</span> <span class="operator">=</span> listLength(head1);</span><br><span class="line">    <span class="type">int</span> <span class="variable">len2</span> <span class="operator">=</span> listLength(head2);</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">l</span> <span class="operator">=</span> len1 &gt;= len2 ? head1 : head2;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">s</span> <span class="operator">=</span> len1 &gt;= len2 ? head2 : head1;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">curL</span> <span class="operator">=</span> l;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">curS</span> <span class="operator">=</span> s;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">last</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">carry</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">curNum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (curS != <span class="literal">null</span>) &#123;</span><br><span class="line">        curNum = curL.value + curS.value + carry;</span><br><span class="line">        curL.value = (curNum % <span class="number">10</span>);</span><br><span class="line">        carry = curNum / <span class="number">10</span>;</span><br><span class="line">        last = curL;</span><br><span class="line">        curL = curL.next;</span><br><span class="line">        curS = curS.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (curL != <span class="literal">null</span>) &#123;</span><br><span class="line">        curNum = curL.value + carry;</span><br><span class="line">        curL.value = curNum % <span class="number">10</span>;</span><br><span class="line">        carry = curNum / <span class="number">10</span>;</span><br><span class="line">        last = curL;</span><br><span class="line">        curL = curL.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (carry == <span class="number">1</span>) &#123;</span><br><span class="line">        last.next = <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="9-4-Question：两个有序链表的合并"><a href="#9-4-Question：两个有序链表的合并" class="headerlink" title="9.4 Question：两个有序链表的合并"></a>9.4 Question：两个有序链表的合并</h3><p>给定两个有序链表的头节点 head1 和 head2，返回合并后的大链表</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ListNode</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">private</span> ListNode next;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ListNode</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">        <span class="built_in">this</span>.next = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">mergeTwoLists</span><span class="params">(ListNode head1, ListNode head2)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (head1 == <span class="literal">null</span> || head2 == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> head1 == <span class="literal">null</span> ? head2 : head1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">head</span> <span class="operator">=</span> head1.value &lt;= head2.value ? head1 : head2;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">cur1</span> <span class="operator">=</span> head.next;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">cur2</span> <span class="operator">=</span> head == head1 ? head2 : head1;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="keyword">while</span> (cur1 != <span class="literal">null</span> &amp;&amp; cur2 != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cur1.value &lt;= cur2.value) &#123;</span><br><span class="line">            pre.next = cur1;</span><br><span class="line">            cur1 = cur1.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            pre.next = cur2;</span><br><span class="line">            cur2 = cur2.next;</span><br><span class="line">        &#125;</span><br><span class="line">        pre = pre.next;</span><br><span class="line">    &#125;</span><br><span class="line">    pre.next = cur1 == <span class="literal">null</span> ? cur2 : cur1;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="10、队列和栈"><a href="#10、队列和栈" class="headerlink" title="10、队列和栈"></a>10、队列和栈</h2><ul>
<li>队列：先进先出（进队的顺序是 abcde，那么出队的顺序也是 abcde）</li>
<li>栈：后进先出（进入的顺序是 abcde，那么出队的顺序是 edcba）</li>
</ul>
<h3 id="10-1-队列"><a href="#10-1-队列" class="headerlink" title="10.1 队列"></a>10.1 队列</h3><p>实现一个队列需要实现几个操作：</p>
<ul>
<li>判断是否为空</li>
<li>返回一个队列中的元素个数</li>
<li>向队列中插入元素</li>
<li>从队列中取出元素</li>
<li>查看即将取出的元素</li>
</ul>
<p>单链表实现队列：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyQueue</span>&lt;V&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> Node&lt;V&gt; head;</span><br><span class="line">    <span class="keyword">private</span> Node&lt;V&gt; tail;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        head = <span class="literal">null</span>;</span><br><span class="line">        tail = <span class="literal">null</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">offer</span><span class="params">(V value)</span> &#123;</span><br><span class="line">        Node&lt;V&gt; cur = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(value);</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">null</span>) &#123;</span><br><span class="line">            head = cur;</span><br><span class="line">            tail = cur;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tail.next = cur;</span><br><span class="line">            tail = cur;</span><br><span class="line">        &#125;</span><br><span class="line">        size ++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">poll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">V</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (head != <span class="literal">null</span>) &#123;</span><br><span class="line">            ans = head.value;</span><br><span class="line">            head = head.next;</span><br><span class="line">            size --;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">null</span>)</span><br><span class="line">            tail = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (head != <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> head.value;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>使用对数器测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    MyQueue&lt;Integer&gt; myQueue = <span class="keyword">new</span> <span class="title class_">MyQueue</span>&lt;&gt;();</span><br><span class="line">    Queue&lt;Integer&gt; test = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">int</span> <span class="variable">testTime</span> <span class="operator">=</span> <span class="number">5000000</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">maxValue</span> <span class="operator">=</span> <span class="number">200000000</span>;</span><br><span class="line">    System.out.println(<span class="string">&quot;start testing&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; testTime; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (myQueue.isEmpty() != test.isEmpty()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Oops!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (myQueue.size() != test.size()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Oops!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">double</span> <span class="variable">decide</span> <span class="operator">=</span> Math.random();</span><br><span class="line">        <span class="keyword">if</span> (decide &lt; <span class="number">0.33</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> (<span class="type">int</span>) (Math.random() * maxValue);</span><br><span class="line">            myQueue.offer(num);</span><br><span class="line">            test.offer(num);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (decide &lt; <span class="number">0.66</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!myQueue.isEmpty()) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">num1</span> <span class="operator">=</span> myQueue.poll();</span><br><span class="line">                <span class="type">int</span> <span class="variable">num2</span> <span class="operator">=</span> test.poll();</span><br><span class="line">                <span class="keyword">if</span> (num1 != num2) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;Oops!&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!myQueue.isEmpty()) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">num1</span> <span class="operator">=</span> myQueue.peek();</span><br><span class="line">                <span class="type">int</span> <span class="variable">num2</span> <span class="operator">=</span> test.peek();</span><br><span class="line">                <span class="keyword">if</span> (num1 != num2) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;Oops!&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">&quot;end the test&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="10-2-栈"><a href="#10-2-栈" class="headerlink" title="10.2 栈"></a>10.2 栈</h3><p>需要实现的功能与队列类似</p>
<p>用单链表实现栈</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;V&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> V value;</span><br><span class="line">    <span class="keyword">private</span> Node&lt;V&gt; next;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Node</span> <span class="params">(V data)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = data;</span><br><span class="line">        <span class="built_in">this</span>.next = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyStack</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line">    <span class="keyword">private</span> Node&lt;V&gt; head;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyStack</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.size = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">this</span>.head = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(V value)</span> &#123;</span><br><span class="line">        Node&lt;V&gt; cur = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;V&gt;(value);</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">null</span>) &#123;</span><br><span class="line">            head = cur;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cur.next = head;</span><br><span class="line">            head.next = cur;</span><br><span class="line">        &#125;</span><br><span class="line">        size ++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">V</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (head != <span class="literal">null</span>) &#123;</span><br><span class="line">            ans = head.value;</span><br><span class="line">            head = head.next;</span><br><span class="line">            size --;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> head != <span class="literal">null</span> ? head.value : <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="10-3-双端队列"><a href="#10-3-双端队列" class="headerlink" title="10.3 双端队列"></a>10.3 双端队列</h3><p>可同时支持在头部和尾部进行插入和删除（或弹出）操作</p>
<p>单链表无法实现在 O(1) 的时间复杂度内完成尾部的弹出操作，因为：如果要删除最后一个元素，需要先找到这个元素的前一个元素，这时如果用单链表的话，需要从头遍历一遍才可以获得目标节点的引用，所以时间复杂度为 O(N)</p>
<p>使用双链表实现双端队列</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;V&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> V value;</span><br><span class="line">    <span class="keyword">private</span> Node&lt;V&gt; next;</span><br><span class="line">    <span class="keyword">private</span> Node&lt;V&gt; last;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Node</span> <span class="params">(V data)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = data;</span><br><span class="line">        <span class="built_in">this</span>.next = <span class="literal">null</span>;</span><br><span class="line">        <span class="built_in">this</span>.last = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyDeqeue</span>&lt;V&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> Node&lt;V&gt; head;</span><br><span class="line">    <span class="keyword">private</span> Node&lt;V&gt; tail;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyDeqeue</span> <span class="params">()</span> &#123;</span><br><span class="line">        head = <span class="literal">null</span>;</span><br><span class="line">        tail = <span class="literal">null</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pushHead</span><span class="params">(V value)</span> &#123;</span><br><span class="line">        Node&lt;V&gt; cur = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(value);</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">null</span>) &#123;</span><br><span class="line">            head = cur;</span><br><span class="line">            tail = cur;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            head.last = cur;</span><br><span class="line">            cur.next = head;</span><br><span class="line">            head = cur;</span><br><span class="line">        &#125;</span><br><span class="line">        size ++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pushTail</span><span class="params">(V value)</span> &#123;</span><br><span class="line">        Node&lt;V&gt; cur = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(value);</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">null</span>) &#123;</span><br><span class="line">            head = cur;</span><br><span class="line">            tail = cur;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tail.next = cur;</span><br><span class="line">            cur.last = tail;</span><br><span class="line">            tail = cur;</span><br><span class="line">        &#125;</span><br><span class="line">        size ++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">pollHead</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">V</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> ( head == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">        size --;</span><br><span class="line">        ans = head.value;</span><br><span class="line">        <span class="keyword">if</span> (head == tail) &#123;</span><br><span class="line">            head = <span class="literal">null</span>;</span><br><span class="line">            tail = <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            head = head.next;</span><br><span class="line">            head.last = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">pollTail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">V</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> ( tail == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">        size --;</span><br><span class="line">        ans = tail.value;</span><br><span class="line">        <span class="keyword">if</span> (head == tail) &#123;</span><br><span class="line">            head = <span class="literal">null</span>;</span><br><span class="line">            tail = <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tail = tail.last;</span><br><span class="line">            tail.next = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="11、位图"><a href="#11、位图" class="headerlink" title="11、位图"></a>11、位图</h2><p>Java 里有一些集合，可以放入许多数字，假设放入的数字都在 0-31 之间，那么把这 32 个数字全部放入集合中就至少需要 32 * 4 bytes 的空间。  </p>
<p>但是，如果用一个 32 位整型数字的每一位是否为 1 来表示的话，就只需要 4 bytes 的空间，位图就是干这事的</p>
<h3 id="11-1-位图的功能"><a href="#11-1-位图的功能" class="headerlink" title="11.1 位图的功能"></a>11.1 位图的功能</h3><p>如果一些的数字的最大值是确定的，那就可以用位图实现一个存放数字的 <strong>集合</strong></p>
<h3 id="11-2-位图的好处"><a href="#11-2-位图的好处" class="headerlink" title="11.2 位图的好处"></a>11.2 位图的好处</h3><p>可以极大地节省（压缩）空间</p>
<h3 id="11-3-位图的实现"><a href="#11-3-位图的实现" class="headerlink" title="11.3 位图的实现"></a>11.3 位图的实现</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">BitMap</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span>[] bits;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BitMap</span><span class="params">(<span class="type">int</span> max)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bits = <span class="keyword">new</span> <span class="title class_">long</span>[(max + <span class="number">64</span>) &gt;&gt; <span class="number">64</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="comment">// num 对 64 取模等同于 num &amp; 63</span></span><br><span class="line">        <span class="comment">// 1、先用 num &gt;&gt; 64 找到用第几个数字</span></span><br><span class="line">        <span class="comment">// 2、用 1L &lt;&lt; (num &amp; 63) 找到第几位</span></span><br><span class="line">        <span class="comment">// 3、用或运算把以这个数字为下标的位置置为 1</span></span><br><span class="line">        <span class="built_in">this</span>.bits[num &gt;&gt; <span class="number">64</span>] |= (<span class="number">1L</span> &lt;&lt; (num &amp; <span class="number">63</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bits[num &gt;&gt; <span class="number">64</span>] &amp;= ~(<span class="number">1L</span> &lt;&lt; (num &amp; <span class="number">63</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">this</span>.bits[num &gt;&gt; <span class="number">64</span>] &amp; (<span class="number">1L</span> &lt;&lt; (num &amp; <span class="number">63</span>))) != <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="11-4-用位运算实现"><a href="#11-4-用位运算实现" class="headerlink" title="11.4 用位运算实现 + - * &#x2F;"></a>11.4 用位运算实现 + - * &#x2F;</h3><p>用 Java 语言里面的位运算实现的 + - * &#x2F; 不如 Java 语言里面的 + - * &#x2F;  快，因为虽然都是位运算，但 Java 的 + - * &#x2F; 是用汇编语言或者 C 语言写的（应该是 C 语言）</p>
<h4 id="11-4-1-加法"><a href="#11-4-1-加法" class="headerlink" title="11.4.1 加法"></a>11.4.1 加法</h4><p>两个数字经过下面两个运算的结果：</p>
<ul>
<li>异或运算：也叫无进位相加</li>
<li>与运算：与出来的结果再左移一位，就是进位的信息</li>
</ul>
<p>无进位相加的算法步骤：</p>
<ol>
<li>a 和 b 异或得到 a’，a 和 b 与运算后左移一位得到 b’；</li>
<li>a’ 和 b’ 异或得到 a’’，a’ 和 b’ 与运算后左移一位得到 b’’；</li>
<li>重复上述过程，直到进位的值为 0，异或得到的无进位相加的结果就是 a 和 b 算术相加的结果</li>
</ol>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (b != <span class="number">0</span>) &#123;</span><br><span class="line">        sum = a ^ b;</span><br><span class="line">        b = (a &amp; b) &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        a = sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="11-4-2-减法"><a href="#11-4-2-减法" class="headerlink" title="11.4.2 减法"></a>11.4.2 减法</h4><p>减法就是 a 加上 b 的相反数，按照补码表示，b 的相反数是 b 取反后加一，所以实现减法的代码为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">minus</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> add(a, add(~b, <span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="11-4-3-乘法"><a href="#11-4-3-乘法" class="headerlink" title="11.4.3 乘法"></a>11.4.3 乘法</h4><p>代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">multi</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (b != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>((b &amp; <span class="number">1</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            res = add(res, a);</span><br><span class="line">        &#125;</span><br><span class="line">        a &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        b &gt;&gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="11-4-4-除法"><a href="#11-4-4-除法" class="headerlink" title="11.4.4 除法"></a>11.4.4 除法</h4><p>假设 a &#x2F; b &#x3D; c，b 是 01110，得到的结果 c 是 00110，那么 a 就等于 b * 2^1 + b * 2^2</p>
<p>题目：a 是 01101100，b 是 00000011，求 a &#x2F; b 的结果 c 是多少？</p>
<p>算法步骤：</p>
<ol>
<li>先将 b 进行左移，让 b 变大到和 a 一样的数量级，并记录 b 左移的位数 s</li>
<li>答案 ans 上第 s 位为 1，a &#x3D; a - b</li>
</ol>
<blockquote>
<p>但实际算法实现过程对算法步骤进行了改进：</p>
<ol>
<li>由于补码的性质，正数和负数不是一种表示方式，所以进行运算的时候全部转化为正数</li>
<li>为了保证安全，使用大的数字向右移动，这样可以避免小的数字左移的过程中发生溢出：</li>
</ol>
</blockquote>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">div</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> a &lt; <span class="number">0</span> ? add(~a, <span class="number">1</span>) : a;</span><br><span class="line">    <span class="type">int</span> <span class="variable">y</span> <span class="operator">=</span> b &lt; <span class="number">0</span> ? add(~b, <span class="number">1</span>) : b;</span><br><span class="line">    <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">30</span>; i &gt;= <span class="number">0</span>; minus(i, <span class="number">1</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span>((x &gt;&gt; i) &gt;= b) &#123;</span><br><span class="line">            res |= (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">            x = minus(x, y &lt;&lt; i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 异或 ^ 可以表示两个二进制数字是否相等</span></span><br><span class="line">    <span class="keyword">return</span> a &lt; <span class="number">0</span> ^ b &lt; <span class="number">0</span> ? add(~res, <span class="number">1</span>) : res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>但系统的最小值由于补码设计的缺陷，导致它没有相反数，所以现需要分情况讨论：</p>
<ol>
<li>a 和 b 都等于 Integer.MIN_VALUE，结果为 1</li>
<li>a 和 b 都不等于 Integer.MIN_VALUE，则调用 div() 方法</li>
<li>a 不等于 Integer.MIN_VALUE，b 等于 Integer.MIN_VALUE，结果为 0（因为分子 a 比分母 b 小，结果的绝对值一定小于 1，向下取整就是 0）</li>
<li>a 等于 Integer.MIN_VALUE，b 不等于 Integer.MIN_VALUE，这个时候因为 a 是最小值，无法调用 div 函数得到正确的结果，所以需要进行特殊处理：<ol>
<li>先用 a + 1 的值除以 b，调用 div 函数得到结果 c</li>
<li>再用 a 的值减去 b*c 的值，得到差值 d</li>
<li>最后用差值 d  除以 b，得到结果 e</li>
<li>那么 a &#x2F; b 的结果就是 c + e</li>
</ol>
</li>
</ol>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">divide</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (a == Integer.MIN_VALUE &amp;&amp; b == Integer.MIN_VALUE) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (a != Integer.MIN_VALUE &amp;&amp; b == Integer.MIN_VALUE) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (a != Integer.MIN_VALUE &amp;&amp; b != Integer.MIN_VALUE) &#123;</span><br><span class="line">        <span class="keyword">return</span> div(a, b);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> div(add(a, <span class="number">1</span>), b);</span><br><span class="line">        <span class="type">int</span> <span class="variable">d</span> <span class="operator">=</span> minus(a, multi(b, c));</span><br><span class="line">        <span class="type">int</span> <span class="variable">e</span> <span class="operator">=</span> div(d, b);</span><br><span class="line">        <span class="keyword">return</span> add(c, e);</span><br><span class="line">        <span class="comment">// 可以简化成一句话</span></span><br><span class="line">        <span class="comment">// return add(div(add(a, 1), b), div(minus(a, multi(b, c)), b));</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="12、比较器-Comparator"><a href="#12、比较器-Comparator" class="headerlink" title="12、比较器 Comparator"></a>12、比较器 Comparator</h2><h3 id="12-1-比较器是什么"><a href="#12-1-比较器是什么" class="headerlink" title="12.1 比较器是什么"></a>12.1 比较器是什么</h3><p>Java 自带的 Arrays 类有一个静态方法 sort()，这个方法可以对数组从小到大进行排序，但这个方法只能用于基础类型 int 的数组，如果要用这个方法对自定义类进行排序的话需要实现一个比较器，以学生类为例：</p>
<p>自定义学生类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name, <span class="type">int</span> id, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&quot;, id=&quot;</span> + id +</span><br><span class="line">            <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">            <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>学生类比较器：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">IdComparator</span> <span class="keyword">implements</span> <span class="title class_">Comparator</span>&lt;Student&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Student o1, Student o2)</span> &#123;</span><br><span class="line">        <span class="comment">// 如果返回 0，认为两个参数相等</span></span><br><span class="line">        <span class="comment">// 如果返回负数，认为第一个参数应该排在前面</span></span><br><span class="line">        <span class="comment">// 如果返回正数，认为第二个参数应该排在前面</span></span><br><span class="line">        <span class="keyword">return</span> o1.id - o2.id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="12-2-自定义类数组和比较器"><a href="#12-2-自定义类数组和比较器" class="headerlink" title="12.2 自定义类数组和比较器"></a>12.2 自定义类数组和比较器</h3><p>在将比较器用于数组中时，调用 sort 方法，和自定义类一并传入</p>
<p>主方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">printStudents</span><span class="params">(Student[] students)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; students.length; i++)</span><br><span class="line">        System.out.println(students[i]);</span><br><span class="line">    System.out.println();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">Student</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">5</span>, <span class="number">27</span>);</span><br><span class="line">    <span class="type">Student</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;李四&quot;</span>, <span class="number">1</span>, <span class="number">17</span>);</span><br><span class="line">    <span class="type">Student</span> <span class="variable">s3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;王五&quot;</span>, <span class="number">4</span>, <span class="number">29</span>);</span><br><span class="line">    <span class="type">Student</span> <span class="variable">s4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;赵六&quot;</span>, <span class="number">3</span>, <span class="number">9</span>);</span><br><span class="line">    <span class="type">Student</span> <span class="variable">s5</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;左七&quot;</span>, <span class="number">2</span>, <span class="number">34</span>);</span><br><span class="line"></span><br><span class="line">    Student[] students = &#123;s1, s2, s3, s4, s5&#125;;</span><br><span class="line">    printStudents(students);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 排序方法</span></span><br><span class="line">    Arrays.sort(students, <span class="keyword">new</span> <span class="title class_">IdComparator</span>());</span><br><span class="line">    printStudents(students);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="12-3-自定义类-List-和比较器"><a href="#12-3-自定义类-List-和比较器" class="headerlink" title="12.3 自定义类 List 和比较器"></a>12.3 自定义类 List 和比较器</h3><p>如果是用 List 进行排序的话，需要在调用 ArrayList 的 sort  方法时传入 比较器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    </span><br><span class="line">    ArrayList&lt;Student&gt; arrayList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    arrayList.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">5</span>, <span class="number">27</span>));</span><br><span class="line">    arrayList.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;李四&quot;</span>, <span class="number">1</span>, <span class="number">17</span>));</span><br><span class="line">    arrayList.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;王五&quot;</span>, <span class="number">4</span>, <span class="number">29</span>));</span><br><span class="line">    arrayList.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;赵六&quot;</span>, <span class="number">3</span>, <span class="number">9</span>));</span><br><span class="line">    arrayList.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;左七&quot;</span>, <span class="number">2</span>, <span class="number">34</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 排序方法</span></span><br><span class="line">    arrayList.sort(<span class="keyword">new</span> <span class="title class_">IdComparator</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arrayList.size(); i++) &#123;</span><br><span class="line">        System.out.println(arrayList.get(i));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="12-4-优先队列-PriorityQueue-和比较器"><a href="#12-4-优先队列-PriorityQueue-和比较器" class="headerlink" title="12.4 优先队列 PriorityQueue 和比较器"></a>12.4 优先队列 PriorityQueue 和比较器</h3><p>Java 中的优先队列 PriorityQueue 使用堆实现，具体地说是使用完全二叉树实现的小顶堆，所以默认定义的优先级队列 PriorityQueue  是最小堆：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.PriorityQueue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    PriorityQueue&lt;Integer&gt; heap = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;();</span><br><span class="line">    heap.add(<span class="number">3</span>);</span><br><span class="line">    heap.add(<span class="number">6</span>);</span><br><span class="line">    System.out.println(heap.peek());</span><br><span class="line">    heap.add(<span class="number">4</span>);</span><br><span class="line">    heap.add(<span class="number">9</span>);</span><br><span class="line">    System.out.println(heap.peek());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">3</span><br><span class="line"></span><br><span class="line">Process finished with <span class="built_in">exit</span> code 0</span><br></pre></td></tr></table></figure>



<p>使用比较器实现最大堆：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Comparator;</span><br><span class="line"></span><br><span class="line">public static class MyComparator implements Comparator&lt;Integer&gt; &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int compare(Integer o1, Integer o2) &#123;</span><br><span class="line">        return o2 - o1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line"> 		// 在定义优先队列的时候把比较器作为参数</span><br><span class="line">        PriorityQueue&lt;Integer&gt; heap = new PriorityQueue&lt;&gt;(new MyComparator());</span><br><span class="line">        heap.add(3);</span><br><span class="line">        heap.add(6);</span><br><span class="line">        System.out.println(heap.peek());</span><br><span class="line">        heap.add(4);</span><br><span class="line">        heap.add(9);</span><br><span class="line">        System.out.println(heap.peek());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">6</span><br><span class="line">9</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>



<p>PriorityQueue 的其他用法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    PriorityQueue&lt;Integer&gt; heap = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;();</span><br><span class="line">    heap.add(<span class="number">3</span>);</span><br><span class="line">    heap.add(<span class="number">6</span>);</span><br><span class="line">    heap.add(<span class="number">4</span>);</span><br><span class="line">    heap.add(<span class="number">9</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!heap.isEmpty()) &#123;</span><br><span class="line">        System.out.println(heap.poll());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">9</span><br><span class="line"></span><br><span class="line">Process finished with <span class="built_in">exit</span> code 0</span><br></pre></td></tr></table></figure>



<h3 id="12-5-Java-中其他跟有序有关的数据结构"><a href="#12-5-Java-中其他跟有序有关的数据结构" class="headerlink" title="12.5 Java 中其他跟有序有关的数据结构"></a>12.5 Java 中其他跟有序有关的数据结构</h3><p>TreeMap</p>
<p>TreeSet：底层红黑树</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">MyComparator</span> <span class="variable">myComparator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyComparator</span>(); </span><br><span class="line">TreeSet&lt;Student&gt; treeSet = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;Student&gt;(myComparator);</span><br></pre></td></tr></table></figure>



<p>此外，比较器也可以使用 lamba 表达式实现</p>
<h3 id="12-6-Question：合并-k-个有序链表"><a href="#12-6-Question：合并-k-个有序链表" class="headerlink" title="12.6 Question：合并 k 个有序链表"></a>12.6 Question：合并 k 个有序链表</h3><ul>
<li>算法步骤：利用最小堆优先队列，先把 k 个有序链表中每个链表的第一个元素（如果不为空）加入优先队列中，然后每次弹出优先队列的第一个元素，依次把这些元素加入到一个空链表中，同时把这个元素指向的下一个元素加入到优先队列中；重复这个过程，直到优先队列中没有元素为止。</li>
<li>时间复杂度：O ( N * log k)</li>
</ul>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ListNode</span> &#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    ListNode next;</span><br><span class="line">    ListNode (<span class="type">int</span> val) &#123;</span><br><span class="line">        <span class="built_in">this</span>.val = val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ListNodeComparator</span> <span class="keyword">implements</span> <span class="title class_">Comparator</span>&lt;ListNode&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(ListNode o1, ListNode o2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> o1.val - o2.val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">mergeKLists</span><span class="params">(ListNode[] lists)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (lists == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    PriorityQueue&lt;ListNode&gt; heap = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">ListNodeComparator</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; lists.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (lists[i] != <span class="literal">null</span>)</span><br><span class="line">            heap.add(lists[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (heap.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">head</span> <span class="operator">=</span> heap.poll();</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="keyword">if</span> (pre.next != <span class="literal">null</span>) &#123;</span><br><span class="line">        heap.add(pre.next);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!heap.isEmpty()) &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> heap.poll();</span><br><span class="line">        pre.next = cur;</span><br><span class="line">        pre = cur;</span><br><span class="line">        <span class="keyword">if</span> (cur.next != <span class="literal">null</span>) &#123;</span><br><span class="line">            heap.add(cur.next);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="13、二叉树"><a href="#13、二叉树" class="headerlink" title="13、二叉树"></a>13、二叉树</h2><p>有序表、红黑树等数据结构底层实现都是二叉树，二叉树的 Java 定义：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">public</span> Node left;</span><br><span class="line">    <span class="keyword">public</span> Node right;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> v)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="13-1-二叉树的遍历方式"><a href="#13-1-二叉树的遍历方式" class="headerlink" title="13.1 二叉树的遍历方式"></a>13.1 二叉树的遍历方式</h3><ul>
<li><p>先序遍历：<strong>根节点</strong>、左子树、右子树</p>
</li>
<li><p>中序遍历：左子树、<strong>根节点</strong>、右子树</p>
</li>
<li><p>后序遍历：左子树、右子树、<strong>根节点</strong></p>
</li>
</ul>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 先序遍历</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">pre</span><span class="params">(Node head)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(head == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    System.out.println(head);</span><br><span class="line">    pre(head.left);</span><br><span class="line">    pre(head.right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 中序遍历</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">in</span><span class="params">(Node head)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(head == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    in(head.left);</span><br><span class="line">    System.out.println(head);</span><br><span class="line">    in(head.right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 后续遍历</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">pos</span><span class="params">(Node head)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(head == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    pos(head.left);</span><br><span class="line">    pos(head.right);</span><br><span class="line">    System.out.println(head);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="13-2-二叉树的递归序"><a href="#13-2-二叉树的递归序" class="headerlink" title="13.2 二叉树的递归序"></a>13.2 二叉树的递归序</h3><p>给定一棵二叉树，它的递归序是唯一的，以下面这棵二叉树为例，它的递归序是：<strong>1 2 4 4 4 2 5 5 5 2 1 3 7 7 7 3 8 8 8 3 1</strong>。而二叉树的三种遍历方式就是在这个递归序的基础上加工而来（递归序保证任何节点都遍历三次）。</p>
<p>以先序遍历为例，第一次遇到节点 1 就直接打印，以此类推。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">graph TB;</span><br><span class="line">1((1))--&gt;2((2))</span><br><span class="line">1((1))--&gt;3((3))</span><br><span class="line">2((2))--&gt;5((4))</span><br><span class="line">2((2))--&gt;6((5))</span><br><span class="line">3((3))--&gt;7((7))</span><br><span class="line">3((3))--&gt;8((8))</span><br></pre></td></tr></table></figure>

<h3 id="13-3-Question：判断是否为一棵树"><a href="#13-3-Question：判断是否为一棵树" class="headerlink" title="13.3 Question：判断是否为一棵树"></a>13.3 Question：判断是否为一棵树</h3><h3 id="13-4-Question：二叉树的最大深度"><a href="#13-4-Question：二叉树的最大深度" class="headerlink" title="13.4 Question：二叉树的最大深度"></a>13.4 Question：二叉树的最大深度</h3><p>力扣地址：<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/maximum-depth-of-binary-tree/">https://leetcode.cn/problems/maximum-depth-of-binary-tree/</a></p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxDepth</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) </span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> Math.max(maxDepth(root.left), maxDepth(root.right)) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="13-5-Question：重新建立二叉树"><a href="#13-5-Question：重新建立二叉树" class="headerlink" title="13.5 Question：重新建立二叉树"></a>13.5 Question：重新建立二叉树</h3><p>力扣地址：<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/zhong-jian-er-cha-shu-lcof/">https://leetcode.cn/problems/zhong-jian-er-cha-shu-lcof/</a></p>
<p>根据中序遍历和先序遍历建立一棵二叉树</p>
<blockquote>
<p>不要过分相信自己脑子的抽象能力，coding 前最好用具体例子证明一下</p>
</blockquote>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> TreeNode <span class="title function_">buildTree</span><span class="params">(<span class="type">int</span>[] preorder, <span class="type">int</span>[] inorder)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (preorder == <span class="literal">null</span> || inorder == <span class="literal">null</span> || preorder.length != inorder.length)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> f(preorder, <span class="number">0</span>, preorder.length-<span class="number">1</span>, inorder, <span class="number">0</span>, inorder.length-<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> TreeNode <span class="title function_">f</span><span class="params">(<span class="type">int</span>[] pre, <span class="type">int</span> l1, <span class="type">int</span> r1, <span class="type">int</span>[] in, <span class="type">int</span> l2, <span class="type">int</span> r2)</span> &#123;</span><br><span class="line">    <span class="comment">// 当前序遍历和中序遍历的结果相同的时，</span></span><br><span class="line">    <span class="keyword">if</span> (l1 &gt; r1)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">head</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(pre[l1]);</span><br><span class="line">    <span class="keyword">if</span> (l1 == r1)</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    <span class="comment">// find 记录中序遍历列表中 pre 头节点值所在 in 数组中的位置</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">find</span> <span class="operator">=</span> l2;</span><br><span class="line">    <span class="keyword">while</span>(in[find] != pre[l1]) &#123;</span><br><span class="line">        find ++;</span><br><span class="line">    &#125;</span><br><span class="line">    head.left = f(pre, l1 + <span class="number">1</span>, l1 + find - l2, in, l2, find - <span class="number">1</span>);</span><br><span class="line">    head.right = f(pre, l1 + find - l2 + <span class="number">1</span>, r1, in, find + <span class="number">1</span>, r2);</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面在中序遍历中查找 pre 的头节点时每次都要遍历，这样效率较低，可以空间换时间：申请一个 HashMap 存放中序遍历每个值的下标</p>
<p>修改后的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> TreeNode <span class="title function_">buildTree</span><span class="params">(<span class="type">int</span>[] preorder, <span class="type">int</span>[] inorder)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (preorder == <span class="literal">null</span> || inorder == <span class="literal">null</span> || preorder.length != inorder.length)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    HashMap&lt;Integer, Integer&gt; valueIndexMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; inorder.length; i++) &#123;</span><br><span class="line">        hashMap.put(inorder[i], i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f(preorder, <span class="number">0</span>, preorder.length-<span class="number">1</span>, inorder, <span class="number">0</span>, inorder.length-<span class="number">1</span>, valueIndexMap);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> TreeNode <span class="title function_">f</span><span class="params">(<span class="type">int</span>[] pre, <span class="type">int</span> l1, <span class="type">int</span> r1, <span class="type">int</span>[] in, <span class="type">int</span> l2, <span class="type">int</span> r2, HashMap&lt;Integer, Integer&gt; valueIndexMap)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (l1 &gt; r1)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">head</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(pre[l1]);</span><br><span class="line">    <span class="keyword">if</span> (l1 == r1)</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    <span class="comment">// find 记录中序遍历列表中 pre 头节点值所在 in 数组中的位置</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">find</span> <span class="operator">=</span> valueIndexMap.get(pre[l1]);</span><br><span class="line">    head.left = f(pre, l1 + <span class="number">1</span>, l1 + find - l2, in, l2, find - <span class="number">1</span>, valueIndexMap);</span><br><span class="line">    head.right = f(pre, l1 + find - l2 + <span class="number">1</span>, r1, in, find + <span class="number">1</span>, r2, valueIndexMap);</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="13-6-Question：二叉树按层遍历并收集节点"><a href="#13-6-Question：二叉树按层遍历并收集节点" class="headerlink" title="13.6 Question：二叉树按层遍历并收集节点"></a>13.6 Question：二叉树按层遍历并收集节点</h3><p>使用队列，每次使用队列的 size 来获取某一层节点的个数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">levelOrderBottom</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; ans = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    queue.add(root);</span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        LinkedList&lt;Integer&gt; temp = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> queue.size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">head</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">            temp.add(head.value);</span><br><span class="line">            <span class="keyword">if</span>(head.left != <span class="literal">null</span>)</span><br><span class="line">                queue.add(head.left);</span><br><span class="line">            <span class="keyword">if</span>(head.right != <span class="literal">null</span>)</span><br><span class="line">                queue.add(head.right);</span><br><span class="line">        &#125;</span><br><span class="line">        ans.add(<span class="number">0</span>, temp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>Java  中的栈实现比较垃圾，建议使用 Java 中 的 LinkedList，或者在明确要放入栈的元素的最大个数的情况下使用数组</p>
<h3 id="13-7-判断是否为平衡搜索二叉树"><a href="#13-7-判断是否为平衡搜索二叉树" class="headerlink" title="13.7 判断是否为平衡搜索二叉树"></a>13.7 判断是否为平衡搜索二叉树</h3><p>平衡树和搜索树的定义：</p>
<ul>
<li><p>平衡树：左树和右树的高度差不超过 1</p>
</li>
<li><p>搜索树：对任何节点来说，它的值大于左树结点的值，小于右树结点的值</p>
</li>
</ul>
<blockquote>
<p>递归的小技巧：如果递归的时候需要返回多个参数，可以额外设计一个类来存放需要返回的信息</p>
</blockquote>
<p>比如下面的 Info：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Info</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> isBalanced;</span><br><span class="line">    <span class="type">int</span> height;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Info</span> <span class="params">(<span class="type">boolean</span> isBalanced, <span class="type">int</span> height)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.isBalanced = isBalanced;</span><br><span class="line">        <span class="built_in">this</span>.height = height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>（1）判断是否为平衡树，代码：</p>
<p>力扣地址：<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/ping-heng-er-cha-shu-lcof/submissions/">https://leetcode.cn/problems/ping-heng-er-cha-shu-lcof/submissions/</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isBalanced</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> process(root).isBalanced;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Info <span class="title function_">process</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>(<span class="literal">true</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="type">Info</span> <span class="variable">left</span> <span class="operator">=</span> process(root.left);</span><br><span class="line">    <span class="type">Info</span> <span class="variable">right</span> <span class="operator">=</span> process(root.right);</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isBalanced</span> <span class="operator">=</span> left.isBalanced &amp;&amp; right.isBalanced</span><br><span class="line">            &amp;&amp;  Math.abs(left.height - right.height) &lt; <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>(isBalanced, Math.max(left.height, right.height) + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>（2）判断是否为搜索树，代码：</p>
<p>力扣地址：<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/validate-binary-search-tree/">https://leetcode.cn/problems/validate-binary-search-tree/</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isValidBST</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> process(root).isSearch;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Info</span> &#123;</span><br><span class="line">    <span class="type">int</span> max;</span><br><span class="line">    <span class="type">int</span> min;</span><br><span class="line">    <span class="type">boolean</span> isSearch;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Info</span><span class="params">(<span class="type">boolean</span> isSearch, <span class="type">int</span> max, <span class="type">int</span> min)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.isSearch = isSearch;</span><br><span class="line">        <span class="built_in">this</span>.max = max;</span><br><span class="line">        <span class="built_in">this</span>.min = min;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Info <span class="title function_">process</span><span class="params">(TreeNode x)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">Info</span> <span class="variable">leftInfo</span> <span class="operator">=</span> process(x.left);</span><br><span class="line">    <span class="type">Info</span> <span class="variable">rightInfo</span> <span class="operator">=</span> process(x.right);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> x.val;</span><br><span class="line">    <span class="type">int</span> <span class="variable">min</span> <span class="operator">=</span> x.val;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (leftInfo != <span class="literal">null</span>) &#123;</span><br><span class="line">        max = Math.max(leftInfo.max, max);</span><br><span class="line">        min = Math.min(leftInfo.min, min);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (rightInfo != <span class="literal">null</span>) &#123;</span><br><span class="line">        max = Math.max(rightInfo.max, max);</span><br><span class="line">        min = Math.min(rightInfo.min, min);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isBST</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (leftInfo != <span class="literal">null</span> &amp;&amp; !leftInfo.isSearch) &#123;</span><br><span class="line">        isBST = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (rightInfo != <span class="literal">null</span> &amp;&amp; !rightInfo.isSearch) &#123;</span><br><span class="line">        isBST = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">leftMaxLessX</span> <span class="operator">=</span> leftInfo == <span class="literal">null</span> ? <span class="literal">true</span> : (leftInfo.max &lt; x.val);</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">rightMinMoreX</span> <span class="operator">=</span> rightInfo == <span class="literal">null</span> ? <span class="literal">true</span> : (rightInfo.min &gt; x.val);</span><br><span class="line">    <span class="keyword">if</span> (!leftMaxLessX || !rightMinMoreX) &#123;</span><br><span class="line">        isBST = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>(isBST, max, min);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="13-8-能否组成路径和"><a href="#13-8-能否组成路径和" class="headerlink" title="13.8 能否组成路径和"></a>13.8 能否组成路径和</h3><p>力扣地址：<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/path-sum/">https://leetcode.cn/problems/path-sum/</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="variable">isSum</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">hasPathSum</span><span class="params">(TreeNode root, <span class="type">int</span> targetSum)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    isSum = <span class="literal">false</span>;</span><br><span class="line">    process(root, <span class="number">0</span>, targetSum);</span><br><span class="line">    <span class="keyword">return</span> isSum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(TreeNode x, <span class="type">int</span> preSum, <span class="type">int</span> targetSum)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (x.left == <span class="literal">null</span> &amp;&amp; x.right == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x.val + preSum == targetSum) &#123;</span><br><span class="line">            isSum = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    preSum += x.val;</span><br><span class="line">    <span class="keyword">if</span> (x.left != <span class="literal">null</span>) &#123;</span><br><span class="line">        process(x.left, preSum, targetSum);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x.right != <span class="literal">null</span>) &#123;</span><br><span class="line">        process(x.right, preSum, targetSum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="13-9-满足路径和的路径"><a href="#13-9-满足路径和的路径" class="headerlink" title="13.9 满足路径和的路径"></a>13.9 满足路径和的路径</h3><p>力扣地址：<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/path-sum-ii/">https://leetcode.cn/problems/path-sum-ii/</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="14、归并排序和快速排序"><a href="#14、归并排序和快速排序" class="headerlink" title="14、归并排序和快速排序"></a>14、归并排序和快速排序</h2><h3 id="14-1-归并排序"><a href="#14-1-归并排序" class="headerlink" title="14.1 归并排序"></a>14.1 归并排序</h3><p>merge sort 时间复杂度为 O( N*logN )</p>
<p>以 4、3、11、5 为例，先让左边（4，3）和右边（11，5）分别有序，然后合并两个有序的数组，并让它继续徐</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chanjechieh.github.io/2022/07/19/%E7%AE%97%E6%B3%95%EF%BC%9A%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/" data-id="clwn8c9f8000kp4sh5fluehal" data-title="算法：从入门到入土" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-使用-Soot-生成-PDG" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/05/05/%E4%BD%BF%E7%94%A8-Soot-%E7%94%9F%E6%88%90-PDG/" class="article-date">
  <time class="dt-published" datetime="2022-05-05T13:10:21.000Z" itemprop="datePublished">2022-05-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/05/05/%E4%BD%BF%E7%94%A8-Soot-%E7%94%9F%E6%88%90-PDG/">使用 Soot 生成程序依赖图</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>首先配置好 <a target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/javase/javase7-archive-downloads.html">Java7</a> 环境（jdk8 不兼容）  </p>
<h2 id="一、使用-idea-创建一个-Java-项目（SootTest）"><a href="#一、使用-idea-创建一个-Java-项目（SootTest）" class="headerlink" title="一、使用 idea 创建一个 Java 项目（SootTest）"></a>一、使用 idea 创建一个 Java 项目（SootTest）</h2><p>照着下面的样子在 SootTest 下创建目录结构（不带后缀的就是文件夹）：  </p>
<ul>
<li>src<ul>
<li>tester<ul>
<li>CallGraph.java</li>
</ul>
</li>
<li>Main.java</li>
</ul>
</li>
</ul>
<p>在 Main.java 文件中输入：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">import soot.*;</span><br><span class="line">import soot.jimple.toolkits.callgraph.CHATransformer;</span><br><span class="line">import soot.jimple.toolkits.callgraph.CallGraph;</span><br><span class="line">import soot.jimple.toolkits.callgraph.Edge;</span><br><span class="line">import soot.jimple.toolkits.callgraph.Targets;</span><br><span class="line">import soot.util.dot.DotGraph;</span><br><span class="line">import soot.util.queue.QueueReader;</span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.util.*;</span><br><span class="line"></span><br><span class="line">public class Main &#123;</span><br><span class="line"></span><br><span class="line">    public static void serializeCallGraph(CallGraph graph, String filename) &#123;</span><br><span class="line">        if (filename == null) &#123;</span><br><span class="line">            filename = soot.SourceLocator.v().getOutputDir();</span><br><span class="line">            if (filename.length() &gt; 0) &#123;</span><br><span class="line">                filename = filename + File.separator;</span><br><span class="line">            &#125;</span><br><span class="line">            filename = filename + &quot;call-graph&quot; + DotGraph.DOT_EXTENSION;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;writing to file &quot; + filename);</span><br><span class="line">        DotGraph canvas = new DotGraph(&quot;call-graph&quot;);</span><br><span class="line">        QueueReader&lt;Edge&gt; listener = graph.listener();</span><br><span class="line">        while (listener.hasNext()) &#123;</span><br><span class="line">            Edge next = listener.next();</span><br><span class="line">            MethodOrMethodContext src = next.getSrc();</span><br><span class="line">            MethodOrMethodContext tgt = next.getTgt();</span><br><span class="line">            String srcString = src.toString();</span><br><span class="line">            String tgtString = tgt.toString();</span><br><span class="line">            if ((!srcString.startsWith(&quot;&lt;java.&quot;) &amp;&amp; !srcString.startsWith(&quot;&lt;sun.&quot;) &amp;&amp; !srcString.startsWith(&quot;&lt;org.&quot;)</span><br><span class="line">                    &amp;&amp; !srcString.startsWith(&quot;&lt;com.&quot;) &amp;&amp; !srcString.startsWith(&quot;&lt;jdk.&quot;)</span><br><span class="line">                    &amp;&amp; !srcString.startsWith(&quot;&lt;javax.&quot;))</span><br><span class="line">                    || (!tgtString.startsWith(&quot;&lt;java.&quot;) &amp;&amp; !tgtString.startsWith(&quot;&lt;sun.&quot;)</span><br><span class="line">                    &amp;&amp; !tgtString.startsWith(&quot;&lt;org.&quot;) &amp;&amp; !tgtString.startsWith(&quot;&lt;com.&quot;)</span><br><span class="line">                    &amp;&amp; !tgtString.startsWith(&quot;&lt;jdk.&quot;) &amp;&amp; !tgtString.startsWith(&quot;&lt;javax.&quot;))) &#123;</span><br><span class="line"></span><br><span class="line">                canvas.drawNode(src.toString());</span><br><span class="line">                canvas.drawNode(tgt.toString());</span><br><span class="line">                canvas.drawEdge(src.toString(), tgt.toString());</span><br><span class="line">                System.out.println(&quot;src = &quot; + srcString);</span><br><span class="line">                System.out.println(&quot;tgt = &quot; + tgtString);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        canvas.plot(filename);</span><br><span class="line">        return;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        // From</span><br><span class="line">        // https://github.com/pcpratts/soot-rb/blob/master/tutorial/guide/examples/call_graph/src/dk/brics/soot/callgraphs/CallGraphExample.java</span><br><span class="line">        List&lt;String&gt; argsList = new ArrayList&lt;String&gt;(Arrays.asList(args));</span><br><span class="line">        argsList.addAll(Arrays.asList(new String[] &#123; &quot;-w&quot;, &quot;-main-class&quot;, &quot;testers.CallGraphs&quot;, // main-class</span><br><span class="line">                &quot;testers.CallGraphs&quot;, // argument classes</span><br><span class="line">                &quot;testers.A&quot; //</span><br><span class="line">        &#125;));</span><br><span class="line">        String[] args2 = new String[argsList.size()];</span><br><span class="line">        args2 = argsList.toArray(args2);</span><br><span class="line">        PackManager.v().getPack(&quot;wjtp&quot;).add(new Transform(&quot;wjtp.myTrans&quot;, new SceneTransformer() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            protected void internalTransform(String phaseName, Map options) &#123;</span><br><span class="line">                CHATransformer.v().transform();</span><br><span class="line">                SootClass a = Scene.v().getSootClass(&quot;testers.A&quot;);</span><br><span class="line">                SootMethod src = Scene.v().getMainClass().getMethodByName(&quot;doStuff&quot;);</span><br><span class="line">                CallGraph cg = Scene.v().getCallGraph();</span><br><span class="line"></span><br><span class="line">                serializeCallGraph(cg, &quot;output&quot; + DotGraph.DOT_EXTENSION);</span><br><span class="line">                System.out.println(&quot;serializeCallGraph completed.&quot;);</span><br><span class="line"></span><br><span class="line">                Iterator&lt;MethodOrMethodContext&gt; targets = new Targets(cg.edgesOutOf(src));</span><br><span class="line">                while (targets.hasNext()) &#123;</span><br><span class="line">                    SootMethod tgt = (SootMethod) targets.next();</span><br><span class="line">                    System.out.println(src + &quot; may call &quot; + tgt);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;));</span><br><span class="line">        args = argsList.toArray(new String[0]);</span><br><span class="line">        soot.Main.main(args2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>CallGraphs.java 文件中的内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package testers;</span><br><span class="line"></span><br><span class="line">public class CallGraphs &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        doStuff();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void doStuff() &#123;</span><br><span class="line">        new A().foo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class A &#123;</span><br><span class="line">    public void foo() &#123;</span><br><span class="line">        bar();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void bar() &#123;</span><br><span class="line">        System.out.println(&quot;in method: bar&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2、配置-Soot-环境"><a href="#2、配置-Soot-环境" class="headerlink" title="2、配置 Soot 环境"></a>2、配置 Soot 环境</h2><p>到 maven 仓库下载 2.5.0 版本的 <a target="_blank" rel="noopener" href="https://mvnrepository.com/artifact/soot/soot/2.5.0">Soot jar</a> 包：  </p>
<p>然后把这个 jar 包导入到刚刚创建的 SootTest 项目</p>
<h2 id="3、运行程序"><a href="#3、运行程序" class="headerlink" title="3、运行程序"></a>3、运行程序</h2><p>运行 Main.java 文件，得到下面的输出和一个 output.dot 文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">Soot started on Thu May 05 21:40:40 CST 2022</span><br><span class="line">[Call Graph] For information on where the call graph may be incomplete, use the verbose option to the cg phase.</span><br><span class="line">[Call Graph] For information on where the call graph may be incomplete, use the verbose option to the cg phase.</span><br><span class="line">writing to file output.dot</span><br><span class="line">src = &lt;testers.CallGraphs: void main(java.lang.String[])&gt;</span><br><span class="line">tgt = &lt;java.lang.Object: void &lt;clinit&gt;()&gt;</span><br><span class="line">src = &lt;testers.CallGraphs: void main(java.lang.String[])&gt;</span><br><span class="line">tgt = &lt;testers.CallGraphs: void doStuff()&gt;</span><br><span class="line">src = &lt;testers.CallGraphs: void doStuff()&gt;</span><br><span class="line">tgt = &lt;java.lang.Object: void &lt;clinit&gt;()&gt;</span><br><span class="line">src = &lt;testers.CallGraphs: void doStuff()&gt;</span><br><span class="line">tgt = &lt;testers.A: void &lt;init&gt;()&gt;</span><br><span class="line">src = &lt;testers.CallGraphs: void doStuff()&gt;</span><br><span class="line">tgt = &lt;testers.A: void foo()&gt;</span><br><span class="line">src = &lt;testers.A: void &lt;init&gt;()&gt;</span><br><span class="line">tgt = &lt;java.lang.Object: void &lt;init&gt;()&gt;</span><br><span class="line">src = &lt;testers.A: void foo()&gt;</span><br><span class="line">tgt = &lt;testers.A: void bar()&gt;</span><br><span class="line">src = &lt;testers.A: void bar()&gt;</span><br><span class="line">tgt = &lt;java.lang.System: void &lt;clinit&gt;()&gt;</span><br><span class="line">src = &lt;testers.A: void bar()&gt;</span><br><span class="line">tgt = &lt;java.lang.Object: void &lt;clinit&gt;()&gt;</span><br><span class="line">src = &lt;testers.A: void bar()&gt;</span><br><span class="line">tgt = &lt;java.io.PrintStream: void println(java.lang.String)&gt;</span><br><span class="line">serializeCallGraph completed.</span><br><span class="line">&lt;testers.CallGraphs: void doStuff()&gt; may call &lt;java.lang.Object: void &lt;clinit&gt;()&gt;</span><br><span class="line">&lt;testers.CallGraphs: void doStuff()&gt; may call &lt;testers.A: void foo()&gt;</span><br><span class="line">&lt;testers.CallGraphs: void doStuff()&gt; may call &lt;testers.A: void &lt;init&gt;()&gt;</span><br><span class="line">Transforming testers.CallGraphs... </span><br><span class="line">Transforming testers.A... </span><br><span class="line">Writing to sootOutput\testers\CallGraphs.class</span><br><span class="line">Writing to sootOutput\testers\A.class</span><br><span class="line">Soot finished on Thu May 05 21:41:26 CST 2022</span><br><span class="line">Soot has run for 0 min. 45 sec.</span><br></pre></td></tr></table></figure>

<h2 id="4、对-dot-文件可视化"><a href="#4、对-dot-文件可视化" class="headerlink" title="4、对 dot 文件可视化"></a>4、对 dot 文件可视化</h2><p>下载安装好 <a target="_blank" rel="noopener" href="https://github.com/tim-lebedkov/packages/releases/download/2019_Q1/org.graphviz.Graphviz-2.38-graphviz-2.38.msi">Graphviz-2.38</a> 后把 bin 文件夹加入系统变量</p>
<p>打开 cmd 命令行并进入 SootTest 项目下，使用下面的命令即可获得 PDG 的可视化结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gvedit</span><br></pre></td></tr></table></figure>

<p>使用下面的命令行生成 png 图片 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dot -Tpng output.dot -o output.png </span><br></pre></td></tr></table></figure>


<p>ps：idea 可以下载打开 dot 文件的插件，但这样子保存的图片太模糊，没法看</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chanjechieh.github.io/2022/05/05/%E4%BD%BF%E7%94%A8-Soot-%E7%94%9F%E6%88%90-PDG/" data-id="clwn8c9f6000dp4sh7ycz738i" data-title="使用 Soot 生成程序依赖图" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Microsoft Visual C++ 14.0 or greater is required." class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/06/17/Microsoft%20Visual%20C++%2014.0%20or%20greater%20is%20required./" class="article-date">
  <time class="dt-published" datetime="2021-06-17T11:33:28.000Z" itemprop="datePublished">2021-06-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/06/17/Microsoft%20Visual%20C++%2014.0%20or%20greater%20is%20required./">error: Microsoft Visual C++ 14.0 or greater is required.</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>解决执行 pip install simpletransformers 时遇到的 bug ：  </p>
<blockquote>
<p>error: Microsoft Visual C++ 14.0 or greater is required. Get it with “Microsoft C++ Build Tools”: <a target="_blank" rel="noopener" href="https://visualstudio.microsoft.com/visual-cpp-build-tools/">https://visualstudio.microsoft.com/visual-cpp-build-tools/</a></p>
</blockquote>
<p>使用错误提示中 <a target="_blank" rel="noopener" href="https://visualstudio.microsoft.com/visual-cpp-build-tools/">链接</a> 下载的安装工具在安装过程中会提示：安装包丢失或毁坏  </p>
<p>为方便以后使用，将 <a target="_blank" rel="noopener" href="https://blog.csdn.net/Zhou_Yulong/article/details/117264550">解决方法</a> 记录在此</p>
<p>并记录一个简历模板：<a target="_blank" rel="noopener" href="https://github.com/mtics/hexo-mtics-resume">https://github.com/mtics/hexo-mtics-resume</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chanjechieh.github.io/2021/06/17/Microsoft%20Visual%20C++%2014.0%20or%20greater%20is%20required./" data-id="clwn8c9ey0001p4sh7g6284sv" data-title="error: Microsoft Visual C++ 14.0 or greater is required." class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-修改Windows中文用户名" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/06/17/%E4%BF%AE%E6%94%B9Windows%E4%B8%AD%E6%96%87%E7%94%A8%E6%88%B7%E5%90%8D/" class="article-date">
  <time class="dt-published" datetime="2021-06-17T11:33:28.000Z" itemprop="datePublished">2021-06-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/06/17/%E4%BF%AE%E6%94%B9Windows%E4%B8%AD%E6%96%87%E7%94%A8%E6%88%B7%E5%90%8D/">修改Windows中文用户名</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="1、修改远程用户名"><a href="#1、修改远程用户名" class="headerlink" title="1、修改远程用户名"></a>1、修改远程用户名</h3><p>进入 <a target="_blank" rel="noopener" href="http://account.live.com/">微软官网</a> ，完成登录后依次点击： “你的信息”，“编辑名称”，修改中文用户名为英文</p>
<p><img src="/%E4%BF%AE%E6%94%B9Windows%E4%B8%AD%E6%96%87%E7%94%A8%E6%88%B7%E5%90%8D/1.png" alt="修改名称"></p>
<h3 id="2、对本地用户名进行同步"><a href="#2、对本地用户名进行同步" class="headerlink" title="2、对本地用户名进行同步"></a>2、对本地用户名进行同步</h3><p>注销当前用户，待注销成功后重新进入Windows系统，发现远程修改好的用户名已同步到本地</p>
<p><img src="/%E4%BF%AE%E6%94%B9Windows%E4%B8%AD%E6%96%87%E7%94%A8%E6%88%B7%E5%90%8D/2.png" alt="本地注销"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chanjechieh.github.io/2021/06/17/%E4%BF%AE%E6%94%B9Windows%E4%B8%AD%E6%96%87%E7%94%A8%E6%88%B7%E5%90%8D/" data-id="clwn8c9f6000ep4sh75ku2ww4" data-title="修改Windows中文用户名" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-pip 因网络下载包失败的解决方法" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/23/pip%20%E5%9B%A0%E7%BD%91%E7%BB%9C%E4%B8%8B%E8%BD%BD%E5%8C%85%E5%A4%B1%E8%B4%A5%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" class="article-date">
  <time class="dt-published" datetime="2021-04-23T02:56:14.000Z" itemprop="datePublished">2021-04-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/04/23/pip%20%E5%9B%A0%E7%BD%91%E7%BB%9C%E4%B8%8B%E8%BD%BD%E5%8C%85%E5%A4%B1%E8%B4%A5%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/">pip因网络问题下载包失败的解决方法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>答案：使用豆瓣源（国内最快）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip --default-timeout=<span class="number">100</span> install 库名称 -i http://pypi.douban.com/simple/ --trusted-host pypi.douban.com</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;更新&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>使用豆瓣下载 torch&#x3D;&#x3D;1.5 时速度不如清华快：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple torch==<span class="number">1.5</span></span><br></pre></td></tr></table></figure>



      
    </div>
    <footer class="article-footer">
      <a data-url="https://chanjechieh.github.io/2021/04/23/pip%20%E5%9B%A0%E7%BD%91%E7%BB%9C%E4%B8%8B%E8%BD%BD%E5%8C%85%E5%A4%B1%E8%B4%A5%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" data-id="clwn8c9f10004p4sh0teo94z1" data-title="pip因网络问题下载包失败的解决方法" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-ubuntu18.0下降低pip版本" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/07/ubuntu18.0%E4%B8%8B%E9%99%8D%E4%BD%8Epip%E7%89%88%E6%9C%AC/" class="article-date">
  <time class="dt-published" datetime="2021-04-07T01:59:00.000Z" itemprop="datePublished">2021-04-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/04/07/ubuntu18.0%E4%B8%8B%E9%99%8D%E4%BD%8Epip%E7%89%88%E6%9C%AC/">ubuntu18.0 下降低 pip 版本</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>华为云学生服务器自带 python 2.7 和 pip 9.0，在安装 gensim 过程中系统提示 pip 有最新版本可以使用便将 pip 升级到了 21.0 版本，但是 pip 21.0 并不支持 python2，所以需要将 pip 降级到 9.0，或将 python 升级到 3.7 及以后的版本，我选择了前者。</p>
<p>解决办法：</p>
<ol>
<li>找到 pip 9.0 的下载地址并下载<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://pypi.python.org/packages/11/b6/abcb525026a4be042b486df43905d6893fb04f05aac21c32c638e939e447/pip-9.0.1.tar.gz#md5=35f01da33009719497f01a4ba69d63c9</span><br></pre></td></tr></table></figure></li>
</ol>
<blockquote>
<p>因为上面记录的地址为查看他人博客得到的，下次试下自己找的：<a target="_blank" rel="noopener" href="https://files.pythonhosted.org/packages/11/b6/abcb525026a4be042b486df43905d6893fb04f05aac21c32c638e939e447/pip-9.0.1.tar.gz">https://files.pythonhosted.org/packages/11/b6/abcb525026a4be042b486df43905d6893fb04f05aac21c32c638e939e447/pip-9.0.1.tar.gz</a></p>
</blockquote>
<ol start="2">
<li><p>解压压缩包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar xf pip-9.0.1.tar.gz </span><br></pre></td></tr></table></figure>
</li>
<li><p>进入解压后的文件夹后安装 pip</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd pip-9.0.1</span><br><span class="line">python setup.py install</span><br></pre></td></tr></table></figure></li>
</ol>
<p>如果整个过程顺利，执行 pip –version 即可看到 pip 已经变为 9.0 版本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://chanjechieh.github.io/2021/04/07/ubuntu18.0%E4%B8%8B%E9%99%8D%E4%BD%8Epip%E7%89%88%E6%9C%AC/" data-id="clwn8c9f20005p4shb5q8hcyk" data-title="ubuntu18.0 下降低 pip 版本" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-关于使用hexo博客插入图片插件后图片地址错误的问题" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/05/19/%E5%85%B3%E4%BA%8E%E4%BD%BF%E7%94%A8hexo%E5%8D%9A%E5%AE%A2%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%8F%92%E4%BB%B6%E5%90%8E%E5%9B%BE%E7%89%87%E5%9C%B0%E5%9D%80%E9%94%99%E8%AF%AF%E7%9A%84%E9%97%AE%E9%A2%98/" class="article-date">
  <time class="dt-published" datetime="2020-05-19T03:52:18.000Z" itemprop="datePublished">2020-05-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/05/19/%E5%85%B3%E4%BA%8E%E4%BD%BF%E7%94%A8hexo%E5%8D%9A%E5%AE%A2%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%8F%92%E4%BB%B6%E5%90%8E%E5%9B%BE%E7%89%87%E5%9C%B0%E5%9D%80%E9%94%99%E8%AF%AF%E7%9A%84%E9%97%AE%E9%A2%98/">关于使用 hexo 博客插入图片插件后图片地址错误的问题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="先介绍一种在-hexo博客-中插入图片的方法："><a href="#先介绍一种在-hexo博客-中插入图片的方法：" class="headerlink" title="先介绍一种在 hexo博客 中插入图片的方法："></a>先介绍一种在 hexo博客 中插入图片的方法：</h4><ol>
<li><p>在 hexo 目录下执行下面的指令来安装这个插件</p>
<blockquote>
<p>npm install hexo-asset-image –save  </p>
</blockquote>
</li>
<li><p>修改 hexo 的配置文件 _config.yml</p>
<blockquote>
<p>原：post_asset_folder: false<br>修改为：post_asset_folder: true</p>
</blockquote>
</li>
</ol>
<p>完成上面的操作后再使用 hexo n 命令 new 一个新的博客时，hexo 会在_post 下创建 md 文件时，同时创建用来存放插图的相同名称的文件夹，以这篇博客为例:</p>
<p><img src="/1.png" alt="演示 hexo 插入图片的方法"></p>
<p>这时在博客中使用下面的代码：</p>
<p><img src="/%E5%85%B3%E4%BA%8E%E4%BD%BF%E7%94%A8hexo%E5%8D%9A%E5%AE%A2%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%8F%92%E4%BB%B6%E5%90%8E%E5%9B%BE%E7%89%87%E5%9C%B0%E5%9D%80%E9%94%99%E8%AF%AF%E7%9A%84%E9%97%AE%E9%A2%98/2.png" alt="演示 hexo 插入图片的方法"></p>
<p>最后看到就是刚刚展示的图片了</p>
<h4 id="这个过程中我遇到的问题"><a href="#这个过程中我遇到的问题" class="headerlink" title="这个过程中我遇到的问题"></a>这个过程中我遇到的问题</h4><p>在写完博客部署到阿里云后，要插入的图片不显示，检查网页后发现图片的地址变成了 &#x2F;.com&#x2F;&#x2F;：</p>
<p><img src="/./%E5%85%B3%E4%BA%8E%E4%BD%BF%E7%94%A8hexo%E5%8D%9A%E5%AE%A2%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%8F%92%E4%BB%B6%E5%90%8E%E5%9B%BE%E7%89%87%E5%9C%B0%E5%9D%80%E9%94%99%E8%AF%AF%E7%9A%84%E9%97%AE%E9%A2%98/3.png" alt="错误示范1"></p>
<h4 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h4><p>虽然图片不能正常显示，但通过访问 <a target="_blank" rel="noopener" href="http://www.smallqi.com/2020/05/19/python%E7%88%AC%E5%8F%96%E7%8C%AB%E7%9C%BC%E7%94%B5%E5%BD%B1TOP100/maoyantop100.jpg">http://www.smallqi.com/2020/05/19/python%E7%88%AC%E5%8F%96%E7%8C%AB%E7%9C%BC%E7%94%B5%E5%BD%B1TOP100/maoyantop100.jpg</a> 却可以查看图片，说明只是图片的地址出现了问题。</p>
<p>baidu 后知道是 hexo-asset-image 插件的一个 bug，使用 npm uninstall hexo-asset-image 卸载后重新安装，再用下面的代码覆盖 hexo-asset-image 下的 index.js：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">import json</span><br><span class="line">import re</span><br><span class="line">import requests</span><br><span class="line">from requests.exceptions import RequestException</span><br><span class="line"></span><br><span class="line">def get_one_page(url):</span><br><span class="line">    try:</span><br><span class="line">        header = &#123;&#x27;User-Agent&#x27;:&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36&#x27;&#125;</span><br><span class="line">        request = requests.get(url, headers = header)</span><br><span class="line">        request.encoding = &#x27;utf-8&#x27;</span><br><span class="line">        if request.status_code == 200:</span><br><span class="line">            return request.text</span><br><span class="line">        return None</span><br><span class="line">    except RequestException:</span><br><span class="line">        return None</span><br><span class="line"></span><br><span class="line">def parse_one_page(html):</span><br><span class="line">    pattern = re.compile(&#x27;&lt;dd&gt;.*?board-index.*?&gt;(\d*)&lt;/i&gt;.*?data-src=&quot;(.*?)&quot;.*?name&quot;&gt;&lt;a&#x27;</span><br><span class="line">                         +&#x27;.*?&gt;(.*?)&lt;/a&gt;.*?star&quot;&gt;(.*?)&lt;/p&gt;.*?releasetime&quot;&gt;(.*?)&lt;/p&gt;&#x27;</span><br><span class="line">                         +&#x27;.*?integer&quot;&gt;(.*?)&lt;/i&gt;.*?fraction&quot;&gt;(.*?)&lt;/i&gt;.*?&lt;/dd&gt;&#x27;, re.S)</span><br><span class="line">    items = re.findall(pattern, html)</span><br><span class="line">    for item in items:</span><br><span class="line">        yield &#123;</span><br><span class="line">            &#x27;index&#x27;: item[0],</span><br><span class="line">            &#x27;title&#x27;: item[2],</span><br><span class="line">            &#x27;image&#x27;: item[1],</span><br><span class="line">            &#x27;actor&#x27;: item[3].strip()[3:],</span><br><span class="line">            &#x27;time&#x27;: item[4].strip()[5:],</span><br><span class="line">            &#x27;score&#x27;: item[5]+item[6]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">def write_to_file(content):</span><br><span class="line">    with open(&quot;maoyantop100.txt&quot;, &#x27;a&#x27;, encoding=&quot;utf-8&quot;) as f:</span><br><span class="line">        f.write(json.dumps(content, ensure_ascii=False) + &#x27;\n&#x27;)</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line">def main(offset):</span><br><span class="line">    url = &quot;https://maoyan.com/board/4?offset=&quot; + str(offset)</span><br><span class="line">    html = get_one_page(url)</span><br><span class="line">    for i in parse_one_page(html):</span><br><span class="line">        print(i)</span><br><span class="line">        write_to_file(i)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    for i in range(10):</span><br><span class="line">        main(i*10)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>最后，重新部署博客时图片地址正确，图片也能正常查看了：</p>
<p><img src="/%E5%85%B3%E4%BA%8E%E4%BD%BF%E7%94%A8hexo%E5%8D%9A%E5%AE%A2%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%8F%92%E4%BB%B6%E5%90%8E%E5%9B%BE%E7%89%87%E5%9C%B0%E5%9D%80%E9%94%99%E8%AF%AF%E7%9A%84%E9%97%AE%E9%A2%98/4.png" alt="正确演示"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chanjechieh.github.io/2020/05/19/%E5%85%B3%E4%BA%8E%E4%BD%BF%E7%94%A8hexo%E5%8D%9A%E5%AE%A2%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%8F%92%E4%BB%B6%E5%90%8E%E5%9B%BE%E7%89%87%E5%9C%B0%E5%9D%80%E9%94%99%E8%AF%AF%E7%9A%84%E9%97%AE%E9%A2%98/" data-id="clwn8c9f7000ip4sh0jva39dv" data-title="关于使用 hexo 博客插入图片插件后图片地址错误的问题" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size: 20px;">教程</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 10px;">算法</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/05/26/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2022/09/26/%E3%80%8A%E5%B0%9A%E5%8C%BB%E9%80%9A%E3%80%8B%E7%AC%94%E8%AE%B0/">《尚医通》笔记</a>
          </li>
        
          <li>
            <a href="/2022/08/23/JVM/">JVM</a>
          </li>
        
          <li>
            <a href="/2022/07/19/%E7%AE%97%E6%B3%95%EF%BC%9A%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/">算法：从入门到入土</a>
          </li>
        
          <li>
            <a href="/2022/05/05/%E4%BD%BF%E7%94%A8-Soot-%E7%94%9F%E6%88%90-PDG/">使用 Soot 生成程序依赖图</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>